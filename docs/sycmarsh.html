<!DOCTYPE html>
<html lang="en-US" xml:lang="en-US">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 3 Sycan Marsh (OR) | DoD cloud2trees Demonstration: Forest Fuel Quantification for Wildfire Modeling using QUIC-Fire</title>
  <meta name="description" content="Using the bookdown package to write a book of data exploration. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 3 Sycan Marsh (OR) | DoD cloud2trees Demonstration: Forest Fuel Quantification for Wildfire Modeling using QUIC-Fire" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Using the bookdown package to write a book of data exploration. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 3 Sycan Marsh (OR) | DoD cloud2trees Demonstration: Forest Fuel Quantification for Wildfire Modeling using QUIC-Fire" />
  
  <meta name="twitter:description" content="Using the bookdown package to write a book of data exploration. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="George Woolsey, Wade Tinkham, Chad Hoffman, and Sophie Bonner" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-preparation.html"/>
<link rel="next" href="fort-stewart-ga.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<script type="text/javascript">

// toggle visibility of R source blocks in R Markdown output
function toggle_R() {
  var x = document.getElementsByClassName('r');
  if (x.length == 0) return;
  function toggle_vis(o) {
    var d = o.style.display;
    o.style.display = (d == 'block' || d == '') ? 'none':'block';
  }

  for (i = 0; i < x.length; i++) {
    var y = x[i];
    if (y.tagName.toLowerCase() === 'pre') toggle_vis(y);
  }

    var elem = document.getElementById("myButton1");
    if (elem.value === "Hide Code") elem.value = "Show Code";
    else elem.value = "Hide Code";
}

document.write('<input onclick="toggle_R();" type="button" value="Hide Code" id="myButton1" style="position: absolute; top: 10%; right: 2%; z-index: 200"></input>')

</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#objective"><i class="fa fa-check"></i><b>1.1</b> Objective</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data_desc"><i class="fa fa-check"></i><b>1.2</b> Data</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#processing-workflow"><i class="fa fa-check"></i><b>1.3</b> Processing Workflow</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-preparation.html"><a href="data-preparation.html"><i class="fa fa-check"></i><b>2</b> Data Preparation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-preparation.html"><a href="data-preparation.html#study-sites"><i class="fa fa-check"></i><b>2.1</b> Study Sites</a></li>
<li class="chapter" data-level="2.2" data-path="data-preparation.html"><a href="data-preparation.html#point-cloud-data"><i class="fa fa-check"></i><b>2.2</b> Point Cloud Data</a></li>
<li class="chapter" data-level="2.3" data-path="data-preparation.html"><a href="data-preparation.html#itd-window-functions"><i class="fa fa-check"></i><b>2.3</b> ITD window functions</a></li>
<li class="chapter" data-level="2.4" data-path="data-preparation.html"><a href="data-preparation.html#other-plotting-functions"><i class="fa fa-check"></i><b>2.4</b> Other plotting functions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sycmarsh.html"><a href="sycmarsh.html"><i class="fa fa-check"></i><b>3</b> Sycan Marsh (OR)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sycmarsh.html"><a href="sycmarsh.html#sy_als"><i class="fa fa-check"></i><b>3.1</b> ALS Processing</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="sycmarsh.html"><a href="sycmarsh.html#itd-tuning"><i class="fa fa-check"></i><b>3.1.1</b> ITD tuning</a></li>
<li class="chapter" data-level="3.1.2" data-path="sycmarsh.html"><a href="sycmarsh.html#cloud2trees-point-cloud-processing"><i class="fa fa-check"></i><b>3.1.2</b> <code>cloud2trees</code> point cloud processing</a></li>
<li class="chapter" data-level="3.1.3" data-path="sycmarsh.html"><a href="sycmarsh.html#cloud2trees-results"><i class="fa fa-check"></i><b>3.1.3</b> <code>cloud2trees</code> Results</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="sycmarsh.html"><a href="sycmarsh.html#sy_uas"><i class="fa fa-check"></i><b>3.2</b> UAS lidar Processing</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="sycmarsh.html"><a href="sycmarsh.html#itd-tuning-1"><i class="fa fa-check"></i><b>3.2.1</b> ITD tuning</a></li>
<li class="chapter" data-level="3.2.2" data-path="sycmarsh.html"><a href="sycmarsh.html#cloud2trees-point-cloud-processing-1"><i class="fa fa-check"></i><b>3.2.2</b> <code>cloud2trees</code> point cloud processing</a></li>
<li class="chapter" data-level="3.2.3" data-path="sycmarsh.html"><a href="sycmarsh.html#cloud2trees-results-1"><i class="fa fa-check"></i><b>3.2.3</b> <code>cloud2trees</code> Results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="fort-stewart-ga.html"><a href="fort-stewart-ga.html"><i class="fa fa-check"></i><b>4</b> Fort Stewart (GA)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="fort-stewart-ga.html"><a href="fort-stewart-ga.html#als-2018-processing"><i class="fa fa-check"></i><b>4.1</b> ALS (2018) Processing</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="fort-stewart-ga.html"><a href="fort-stewart-ga.html#itd-tuning-2"><i class="fa fa-check"></i><b>4.1.1</b> ITD tuning</a></li>
<li class="chapter" data-level="4.1.2" data-path="fort-stewart-ga.html"><a href="fort-stewart-ga.html#cloud2trees-point-cloud-processing-2"><i class="fa fa-check"></i><b>4.1.2</b> <code>cloud2trees</code> point cloud processing</a></li>
<li class="chapter" data-level="4.1.3" data-path="fort-stewart-ga.html"><a href="fort-stewart-ga.html#cloud2trees-results-2"><i class="fa fa-check"></i><b>4.1.3</b> <code>cloud2trees</code> Results</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="fort-stewart-ga.html"><a href="fort-stewart-ga.html#als-2025-processing"><i class="fa fa-check"></i><b>4.2</b> ALS (2025) Processing</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="fort-stewart-ga.html"><a href="fort-stewart-ga.html#itd-tuning-3"><i class="fa fa-check"></i><b>4.2.1</b> ITD tuning</a></li>
<li class="chapter" data-level="4.2.2" data-path="fort-stewart-ga.html"><a href="fort-stewart-ga.html#cloud2trees-point-cloud-processing-3"><i class="fa fa-check"></i><b>4.2.2</b> <code>cloud2trees</code> point cloud processing</a></li>
<li class="chapter" data-level="4.2.3" data-path="fort-stewart-ga.html"><a href="fort-stewart-ga.html#cloud2trees-results-3"><i class="fa fa-check"></i><b>4.2.3</b> <code>cloud2trees</code> Results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="salt-cabin-co.html"><a href="salt-cabin-co.html"><i class="fa fa-check"></i><b>5</b> Salt Cabin (CO)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="salt-cabin-co.html"><a href="salt-cabin-co.html#sc_als"><i class="fa fa-check"></i><b>5.1</b> ALS Processing</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="salt-cabin-co.html"><a href="salt-cabin-co.html#itd-tuning-4"><i class="fa fa-check"></i><b>5.1.1</b> ITD tuning</a></li>
<li class="chapter" data-level="5.1.2" data-path="salt-cabin-co.html"><a href="salt-cabin-co.html#cloud2trees-point-cloud-processing-4"><i class="fa fa-check"></i><b>5.1.2</b> <code>cloud2trees</code> point cloud processing</a></li>
<li class="chapter" data-level="5.1.3" data-path="salt-cabin-co.html"><a href="salt-cabin-co.html#cloud2trees-results-4"><i class="fa fa-check"></i><b>5.1.3</b> <code>cloud2trees</code> Results</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="salt-cabin-co.html"><a href="salt-cabin-co.html#sc_uas"><i class="fa fa-check"></i><b>5.2</b> UAS sfm Processing</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="salt-cabin-co.html"><a href="salt-cabin-co.html#itd-tuning-5"><i class="fa fa-check"></i><b>5.2.1</b> ITD tuning</a></li>
<li class="chapter" data-level="5.2.2" data-path="salt-cabin-co.html"><a href="salt-cabin-co.html#cloud2trees-point-cloud-processing-5"><i class="fa fa-check"></i><b>5.2.2</b> <code>cloud2trees</code> point cloud processing</a></li>
<li class="chapter" data-level="5.2.3" data-path="salt-cabin-co.html"><a href="salt-cabin-co.html#cloud2trees-results-5"><i class="fa fa-check"></i><b>5.2.3</b> <code>cloud2trees</code> Results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="cedar-bridge-nj.html"><a href="cedar-bridge-nj.html"><i class="fa fa-check"></i><b>6</b> Cedar Bridge (NJ)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="cedar-bridge-nj.html"><a href="cedar-bridge-nj.html#als-processing"><i class="fa fa-check"></i><b>6.1</b> ALS Processing</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="cedar-bridge-nj.html"><a href="cedar-bridge-nj.html#itd-tuning-6"><i class="fa fa-check"></i><b>6.1.1</b> ITD tuning</a></li>
<li class="chapter" data-level="6.1.2" data-path="cedar-bridge-nj.html"><a href="cedar-bridge-nj.html#cloud2trees-point-cloud-processing-6"><i class="fa fa-check"></i><b>6.1.2</b> <code>cloud2trees</code> point cloud processing</a></li>
<li class="chapter" data-level="6.1.3" data-path="cedar-bridge-nj.html"><a href="cedar-bridge-nj.html#cloud2trees-results-6"><i class="fa fa-check"></i><b>6.1.3</b> <code>cloud2trees</code> Results</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="cedar-bridge-nj.html"><a href="cedar-bridge-nj.html#uas-lidar-processing"><i class="fa fa-check"></i><b>6.2</b> UAS lidar Processing</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="cedar-bridge-nj.html"><a href="cedar-bridge-nj.html#itd-tuning-7"><i class="fa fa-check"></i><b>6.2.1</b> ITD tuning</a></li>
<li class="chapter" data-level="6.2.2" data-path="cedar-bridge-nj.html"><a href="cedar-bridge-nj.html#cloud2trees-point-cloud-processing-7"><i class="fa fa-check"></i><b>6.2.2</b> <code>cloud2trees</code> point cloud processing</a></li>
<li class="chapter" data-level="6.2.3" data-path="cedar-bridge-nj.html"><a href="cedar-bridge-nj.html#cloud2trees-results-7"><i class="fa fa-check"></i><b>6.2.3</b> <code>cloud2trees</code> Results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="point-cloud-processing-results.html"><a href="point-cloud-processing-results.html"><i class="fa fa-check"></i><b>7</b> Point Cloud Processing Results</a>
<ul>
<li class="chapter" data-level="7.1" data-path="point-cloud-processing-results.html"><a href="point-cloud-processing-results.html#processing-time"><i class="fa fa-check"></i><b>7.1</b> Processing Time</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="point-cloud-processing-results.html"><a href="point-cloud-processing-results.html#point-cloud-processing-time-versus-point-density"><i class="fa fa-check"></i><b>7.1.1</b> Point Cloud Processing Time versus Point Density</a></li>
<li class="chapter" data-level="7.1.2" data-path="point-cloud-processing-results.html"><a href="point-cloud-processing-results.html#point-cloud-processing-time-by-section"><i class="fa fa-check"></i><b>7.1.2</b> Point Cloud Processing Time by Section (%)</a></li>
<li class="chapter" data-level="7.1.3" data-path="point-cloud-processing-results.html"><a href="point-cloud-processing-results.html#point-cloud-processing-time-by-section-total"><i class="fa fa-check"></i><b>7.1.3</b> Point Cloud Processing Time by Section (total)</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="point-cloud-processing-results.html"><a href="point-cloud-processing-results.html#silvicultural-metrics"><i class="fa fa-check"></i><b>7.2</b> Silvicultural Metrics</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="point-cloud-processing-results.html"><a href="point-cloud-processing-results.html#example"><i class="fa fa-check"></i><b>7.2.1</b> Example</a></li>
<li class="chapter" data-level="7.2.2" data-path="point-cloud-processing-results.html"><a href="point-cloud-processing-results.html#study-area-summaries"><i class="fa fa-check"></i><b>7.2.2</b> Study Area Summaries</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="lanl_trees.html"><a href="lanl_trees.html"><i class="fa fa-check"></i><b>8</b> <code>cloud2trees</code> to LANL TREES</a>
<ul>
<li class="chapter" data-level="8.1" data-path="lanl_trees.html"><a href="lanl_trees.html#surface-fuel-quantification"><i class="fa fa-check"></i><b>8.1</b> Surface Fuel Quantification</a></li>
<li class="chapter" data-level="8.2" data-path="lanl_trees.html"><a href="lanl_trees.html#cloud2treescloud2trees_to_lanl_trees-example-process"><i class="fa fa-check"></i><b>8.2</b> <code>cloud2trees::cloud2trees_to_lanl_trees()</code> example process</a></li>
<li class="chapter" data-level="8.3" data-path="lanl_trees.html"><a href="lanl_trees.html#cloud2treescloud2trees_to_lanl_trees-everything"><i class="fa fa-check"></i><b>8.3</b> <code>cloud2trees::cloud2trees_to_lanl_trees()</code> everything</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="d-fuel-structures.html"><a href="d-fuel-structures.html"><i class="fa fa-check"></i><b>9</b> 3D Fuel Structures</a>
<ul>
<li class="chapter" data-level="9.1" data-path="d-fuel-structures.html"><a href="d-fuel-structures.html#salt-cabin-co---als"><i class="fa fa-check"></i><b>9.1</b> Salt Cabin (CO) - ALS</a></li>
<li class="chapter" data-level="9.2" data-path="d-fuel-structures.html"><a href="d-fuel-structures.html#salt-cabin-co---uas-sfm"><i class="fa fa-check"></i><b>9.2</b> Salt Cabin (CO) - UAS-SfM</a></li>
<li class="chapter" data-level="9.3" data-path="d-fuel-structures.html"><a href="d-fuel-structures.html#sycan-marsh-or---als"><i class="fa fa-check"></i><b>9.3</b> Sycan Marsh (OR) - ALS</a></li>
<li class="chapter" data-level="9.4" data-path="d-fuel-structures.html"><a href="d-fuel-structures.html#sycan-marsh-or---uas-lidar"><i class="fa fa-check"></i><b>9.4</b> Sycan Marsh (OR) - UAS-lidar</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="lessons-learned.html"><a href="lessons-learned.html"><i class="fa fa-check"></i><b>10</b> Lessons Learned</a>
<ul>
<li class="chapter" data-level="10.1" data-path="lessons-learned.html"><a href="lessons-learned.html#data-processing-challengesgaps"><i class="fa fa-check"></i><b>10.1</b> Data Processing Challenges/Gaps</a></li>
<li class="chapter" data-level="10.2" data-path="lessons-learned.html"><a href="lessons-learned.html#challenges-with-these-demos"><i class="fa fa-check"></i><b>10.2</b> Challenges with these Demos</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DoD cloud2trees Demonstration: Forest Fuel Quantification for Wildfire Modeling using QUIC-Fire</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sycmarsh" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Section 3</span> Sycan Marsh (OR)<a href="sycmarsh.html#sycmarsh" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>process the point cloud data for the Sycan Marsh (OR) study site</p>
<p>let’s check out the data we have and the area</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="sycmarsh.html#cb20-1" tabindex="-1"></a><span class="co"># just get the data we care about</span></span>
<span id="cb20-2"><a href="sycmarsh.html#cb20-2" tabindex="-1"></a>aoi_study_site <span class="ot">&lt;-</span> <span class="st">&quot;SycanMarsh&quot;</span></span>
<span id="cb20-3"><a href="sycmarsh.html#cb20-3" tabindex="-1"></a>aoi_sf <span class="ot">&lt;-</span> study_sites_sf <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(study_site <span class="sc">==</span> aoi_study_site)</span>
<span id="cb20-4"><a href="sycmarsh.html#cb20-4" tabindex="-1"></a>aoi_las_ctg <span class="ot">&lt;-</span> study_sites_las_ctg <span class="sc">%&gt;%</span> </span>
<span id="cb20-5"><a href="sycmarsh.html#cb20-5" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">keep_at</span>(</span>
<span id="cb20-6"><a href="sycmarsh.html#cb20-6" tabindex="-1"></a>    <span class="fu">names</span>(study_sites_las_ctg)[</span>
<span id="cb20-7"><a href="sycmarsh.html#cb20-7" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_detect</span>(<span class="fu">names</span>(study_sites_las_ctg), aoi_study_site)</span>
<span id="cb20-8"><a href="sycmarsh.html#cb20-8" tabindex="-1"></a>    ]</span>
<span id="cb20-9"><a href="sycmarsh.html#cb20-9" tabindex="-1"></a>  )</span>
<span id="cb20-10"><a href="sycmarsh.html#cb20-10" tabindex="-1"></a><span class="co"># option to put satellite imagery as base layer of mapview maps</span></span>
<span id="cb20-11"><a href="sycmarsh.html#cb20-11" tabindex="-1"></a>mapview<span class="sc">::</span><span class="fu">mapviewOptions</span>(</span>
<span id="cb20-12"><a href="sycmarsh.html#cb20-12" tabindex="-1"></a>  <span class="at">homebutton =</span> <span class="cn">FALSE</span></span>
<span id="cb20-13"><a href="sycmarsh.html#cb20-13" tabindex="-1"></a>  , <span class="at">basemaps =</span> <span class="fu">c</span>(<span class="st">&quot;Esri.WorldImagery&quot;</span>,<span class="st">&quot;OpenStreetMap&quot;</span>)</span>
<span id="cb20-14"><a href="sycmarsh.html#cb20-14" tabindex="-1"></a>)</span>
<span id="cb20-15"><a href="sycmarsh.html#cb20-15" tabindex="-1"></a><span class="co"># map it</span></span>
<span id="cb20-16"><a href="sycmarsh.html#cb20-16" tabindex="-1"></a><span class="co"># add the study bounds</span></span>
<span id="cb20-17"><a href="sycmarsh.html#cb20-17" tabindex="-1"></a>mapview<span class="sc">::</span><span class="fu">mapview</span>(</span>
<span id="cb20-18"><a href="sycmarsh.html#cb20-18" tabindex="-1"></a>  aoi_las_ctg[[<span class="dv">1</span>]]<span class="sc">$</span>geometry</span>
<span id="cb20-19"><a href="sycmarsh.html#cb20-19" tabindex="-1"></a>  , <span class="at">color =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb20-20"><a href="sycmarsh.html#cb20-20" tabindex="-1"></a>  , <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb20-21"><a href="sycmarsh.html#cb20-21" tabindex="-1"></a>  , <span class="at">alpha.regions =</span> <span class="dv">0</span></span>
<span id="cb20-22"><a href="sycmarsh.html#cb20-22" tabindex="-1"></a>  , <span class="at">layer.name =</span> <span class="fu">names</span>(aoi_las_ctg[<span class="dv">1</span>])</span>
<span id="cb20-23"><a href="sycmarsh.html#cb20-23" tabindex="-1"></a>  , <span class="at">legend =</span> F</span>
<span id="cb20-24"><a href="sycmarsh.html#cb20-24" tabindex="-1"></a>  , <span class="at">popup =</span> F</span>
<span id="cb20-25"><a href="sycmarsh.html#cb20-25" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb20-26"><a href="sycmarsh.html#cb20-26" tabindex="-1"></a>mapview<span class="sc">::</span><span class="fu">mapview</span>(</span>
<span id="cb20-27"><a href="sycmarsh.html#cb20-27" tabindex="-1"></a>  aoi_las_ctg[[<span class="dv">2</span>]]<span class="sc">$</span>geometry</span>
<span id="cb20-28"><a href="sycmarsh.html#cb20-28" tabindex="-1"></a>  , <span class="at">color =</span> <span class="st">&quot;gray&quot;</span></span>
<span id="cb20-29"><a href="sycmarsh.html#cb20-29" tabindex="-1"></a>  , <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb20-30"><a href="sycmarsh.html#cb20-30" tabindex="-1"></a>  , <span class="at">alpha.regions =</span> <span class="dv">0</span></span>
<span id="cb20-31"><a href="sycmarsh.html#cb20-31" tabindex="-1"></a>  , <span class="at">layer.name =</span> <span class="fu">names</span>(aoi_las_ctg[<span class="dv">2</span>])</span>
<span id="cb20-32"><a href="sycmarsh.html#cb20-32" tabindex="-1"></a>  , <span class="at">legend =</span> F</span>
<span id="cb20-33"><a href="sycmarsh.html#cb20-33" tabindex="-1"></a>  , <span class="at">popup =</span> F</span>
<span id="cb20-34"><a href="sycmarsh.html#cb20-34" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb20-35"><a href="sycmarsh.html#cb20-35" tabindex="-1"></a>mapview<span class="sc">::</span><span class="fu">mapview</span>(</span>
<span id="cb20-36"><a href="sycmarsh.html#cb20-36" tabindex="-1"></a>  aoi_sf</span>
<span id="cb20-37"><a href="sycmarsh.html#cb20-37" tabindex="-1"></a>  , <span class="at">zcol =</span> <span class="st">&quot;study_site_lab&quot;</span></span>
<span id="cb20-38"><a href="sycmarsh.html#cb20-38" tabindex="-1"></a>  , <span class="at">color =</span> <span class="st">&quot;navy&quot;</span></span>
<span id="cb20-39"><a href="sycmarsh.html#cb20-39" tabindex="-1"></a>  , <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb20-40"><a href="sycmarsh.html#cb20-40" tabindex="-1"></a>  , <span class="at">alpha.regions =</span> <span class="dv">0</span></span>
<span id="cb20-41"><a href="sycmarsh.html#cb20-41" tabindex="-1"></a>  , <span class="at">legend =</span> T</span>
<span id="cb20-42"><a href="sycmarsh.html#cb20-42" tabindex="-1"></a>  , <span class="at">popup =</span> F</span>
<span id="cb20-43"><a href="sycmarsh.html#cb20-43" tabindex="-1"></a>)</span></code></pre></div>
<div class="leaflet html-widget html-fill-item" id="htmlwidget-6259eb08c6e99ca3ebf3" style="width:1008px;height:672px;"></div>
<script type="application/json" data-for="htmlwidget-6259eb08c6e99ca3ebf3">{"x":{"options":{"minZoom":1,"maxZoom":52,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"preferCanvas":false,"bounceAtZoomLimits":false,"maxBounds":[[[-90,-370]],[[90,370]]]},"calls":[{"method":"addProviderTiles","args":["Esri.WorldImagery","Esri.WorldImagery","Esri.WorldImagery",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap","OpenStreetMap","OpenStreetMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"createMapPane","args":["polygon",420]},{"method":"addPolygons","args":[[[[{"lng":[-121.1516243760736,-121.1513557455988,-121.1391194762657,-121.1393898823264,-121.1516243760736],"lat":[42.86067272720634,42.86967324534542,42.86947495358417,42.86047449749015,42.86067272720634]}]],[[{"lng":[-121.1393897599809,-121.1391193539024,-121.1268832089352,-121.1271553905322,-121.1393897599809],"lat":[42.86047449550129,42.8694749515947,42.86927535285178,42.860274959212,42.86047449550129]}]]],null,"SycanMarsh_als_2021",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"polygon","stroke":true,"color":"black","weight":2,"opacity":0.9,"fill":true,"fillColor":"#6666ff","fillOpacity":0,"smoothFactor":1,"noClip":false},null,{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},["1","2"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},{"stroke":true,"weight":3,"opacity":0.9,"fillOpacity":0,"bringToFront":false,"sendToBack":false}]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addPolygons","args":[[[[{"lng":[-121.1456056848988,-121.1454296429296,-121.1355001025844,-121.135677085771,-121.1456056848988],"lat":[42.86261655630993,42.86849578986786,42.86833446533024,42.86245526474691,42.86261655630993]}]]],null,"SycanMarsh_uas_lidar_2023",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"polygon","stroke":true,"color":"gray","weight":2,"opacity":0.9,"fill":true,"fillColor":"#6666ff","fillOpacity":0,"smoothFactor":1,"noClip":false},null,{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},"1",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},{"stroke":true,"weight":3,"opacity":0.9,"fillOpacity":0,"bringToFront":false,"sendToBack":false}]},{"method":"addPolygons","args":[[[[{"lng":[-121.1373473783048,-121.1374169439512,-121.1375443412801,-121.1375891966996,-121.1376823019137,-121.1376837239468,-121.1378192946631,-121.1380171019273,-121.1380243488403,-121.1382239257586,-121.1386102165618,-121.1390396761315,-121.1395081793775,-121.1399883548254,-121.1403586243054,-121.1407541569182,-121.1410012977035,-121.1413581616594,-121.1417895028625,-121.1419984038591,-121.1424112827213,-121.1426650360457,-121.142997947872,-121.1432778994964,-121.1437194110858,-121.1441869335336,-121.1446288184504,-121.1448469571976,-121.1450105817855,-121.1449954231575,-121.1448114066614,-121.1447127578605,-121.1444741771837,-121.1442784672213,-121.1440821030362,-121.1438681226393,-121.1436711970734,-121.1434747372723,-121.1433334040553,-121.1431447708347,-121.1428790626337,-121.1427148420214,-121.142594052559,-121.1424731705396,-121.1422801079457,-121.1421262380063,-121.1419799115164,-121.1419019940199,-121.1418098576191,-121.1416666476449,-121.1415537761267,-121.141407168498,-121.1412215537196,-121.1411016045782,-121.1408910142411,-121.1406646793846,-121.140574131561,-121.1405006394177,-121.1403796593252,-121.1403051368941,-121.1402128080061,-121.1401204800191,-121.140031923721,-121.1399588051584,-121.1398688178368,-121.1397404781093,-121.1395526793548,-121.1393742977962,-121.1392563144536,-121.1391672636193,-121.1390605957628,-121.1388403723674,-121.1387258786271,-121.1386077081676,-121.1384812434715,-121.1383710850562,-121.1382564039424,-121.1381249492007,-121.138031471904,-121.1379706979929,-121.1379184995456,-121.1378699775133,-121.1378088295069,-121.1377224246846,-121.1376418755766,-121.137247763963,-121.1371048495636,-121.1369992749036,-121.1368844032274,-121.1367078339592,-121.1366630185089,-121.1365197801961,-121.1363861510511,-121.1363783285027,-121.1363764330219,-121.1363206340807,-121.1362029931321,-121.136183351409,-121.1362258909804,-121.1363452863991,-121.1364607410158,-121.1365466870228,-121.1365527781815,-121.1365387412,-121.1366370119767,-121.1367579002735,-121.136867012683,-121.1369126385582,-121.1370514714993,-121.1371657936735,-121.137197360025,-121.1373015822583,-121.1373431825797,-121.1373473783048],"lat":[42.86461254036364,42.86431116344429,42.86399254998357,42.86395112723326,42.86373748368425,42.86369018588064,42.86348987153467,42.86337396047733,42.86336740994703,42.86345830694204,42.86359571088054,42.86370884006197,42.86393499078272,42.86405518497832,42.86416110300671,42.86427367475557,42.86424022546081,42.86422728978516,42.86427800150555,42.86438753815472,42.86448789759539,42.8645169911721,42.86445371052827,42.86445825270337,42.86445292660726,42.86442928938783,42.86441147798067,42.86449618414206,42.86468504236848,42.86485429251332,42.86490748629173,42.86494333773279,42.8649769203736,42.86499559345809,42.86503610167507,42.86509817093678,42.86515739481669,42.86520102108749,42.86524554188898,42.86531114148314,42.86540045723823,42.86550078155805,42.8655674808608,42.86563730002235,42.86570906756955,42.86574714136721,42.86581654623701,42.86586833659121,42.86596982952023,42.86607673553188,42.86616228774039,42.86624105094451,42.86634726709528,42.86638589116755,42.86647609641194,42.86652547489732,42.86657393775109,42.8666195569289,42.86669249295359,42.86677242561752,42.86688015633738,42.86698788697441,42.867111282785,42.86714442434435,42.86717417118531,42.86720953604168,42.86724705514376,42.86725351815626,42.86722663216118,42.86722518393705,42.86724529627227,42.86723235283112,42.86723049155407,42.86720984396799,42.86718282018842,42.86717790660558,42.86718228303685,42.86718014532599,42.86718486632478,42.86723069076287,42.86727353401122,42.86733516165273,42.86739346415639,42.86744511280197,42.86747070063647,42.86735352405002,42.86731103220522,42.86727964236606,42.86724548836745,42.86713104498718,42.86712202364418,42.86708848254762,42.86701764664659,42.86693713706902,42.86691761972697,42.86679811806904,42.86667487742027,42.86654455035313,42.86639452162208,42.86619394571976,42.86612434801196,42.86595896620636,42.86575654505868,42.86568483894207,42.86556387720687,42.86546183967533,42.86535960950866,42.86531159899111,42.86510259588719,42.86482710737594,42.86478980681524,42.86462130437127,42.86450946665045,42.86461254036364]}]]],null,"aoi_sf - study_site_lab",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"polygon","stroke":true,"color":"#000080","weight":2,"opacity":0.9,"fill":true,"fillColor":"#6666FF","fillOpacity":0,"smoothFactor":1,"noClip":false},null,{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},"Sycan Marsh (OR)",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},{"stroke":true,"weight":3,"opacity":0.9,"fillOpacity":0,"bringToFront":false,"sendToBack":false}]},{"method":"addLayersControl","args":[["Esri.WorldImagery","OpenStreetMap"],["SycanMarsh_als_2021","SycanMarsh_uas_lidar_2023","aoi_sf - study_site_lab"],{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"addLegend","args":[{"colors":["#6666FF"],"labels":["Sycan Marsh (OR)"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"factor","title":"","extra":null,"layerId":null,"className":"info legend","group":"aoi_sf - study_site_lab"}]},{"method":"addHomeButton","args":[-121.1516243760736,42.860274959212,-121.1268832089352,42.86967324534542,true,null,"Zoom to full extent","<strong>Zoom full<\/strong>","bottomleft"]}],"limits":{"lat":[42.860274959212,42.86967324534542],"lng":[-121.1516243760736,-121.1268832089352]},"fitBounds":[42.860274959212,-121.1516243760736,42.86967324534542,-121.1268832089352,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n      function(el, x, data) {\n      // get the leaflet map\n      var map = this; //HTMLWidgets.find('#' + el.id);\n      // we need a new div element because we have to handle\n      // the mouseover output separately\n      // debugger;\n      function addElement () {\n      // generate new div Element\n      var newDiv = $(document.createElement('div'));\n      // append at end of leaflet htmlwidget container\n      $(el).append(newDiv);\n      //provide ID and style\n      newDiv.addClass('lnlt');\n      newDiv.css({\"position\":\"relative\",\"bottomleft\":\"0px\",\"background-color\":\"rgba(255, 255, 255, 0.7)\",\"box-shadow\":\"0 0 2px #bbb\",\"background-clip\":\"padding-box\",\"margin\":\"0\",\"padding-left\":\"5px\",\"padding-right\":\"5px\",\"color\":\"#333\",\"font-size\":\"9px\",\"font-family\":\"\\\"Helvetica Neue\\\", Arial, Helvetica, sans-serif\",\"text-align\":\"left\",\"z-index\":\"700\"});\n      return newDiv;\n      }\n\n\n      // check for already existing lnlt class to not duplicate\n      var lnlt = $(el).find('.lnlt');\n\n      if(!lnlt.length) {\n      lnlt = addElement();\n\n      // grab the special div we generated in the beginning\n      // and put the mousmove output there\n\n      map.on('mousemove', function (e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                           ' | zoom: ' + map.getZoom() +\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\n                           ' | epsg: 3857 ' +\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\n      } else {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      }\n      });\n\n      // remove the lnlt div when mouse leaves map\n      map.on('mouseout', function (e) {\n      var strip = document.querySelector('.lnlt');\n      if( strip !==null) strip.remove();\n      });\n\n      };\n\n      //$(el).keypress(67, function(e) {\n      map.on('preclick', function(e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      var txt = document.querySelector('.lnlt').textContent;\n      console.log(txt);\n      //txt.innerText.focus();\n      //txt.select();\n      setClipboardText('\"' + txt + '\"');\n      }\n      });\n\n      }\n      ).call(this.getMap(), el, x, data);\n}","data":null},{"code":"function(el, x, data) {\n  return (function(el,x,data){\n           var map = this;\n\n           map.on('keypress', function(e) {\n               console.log(e.originalEvent.code);\n               var key = e.originalEvent.code;\n               if (key === 'KeyE') {\n                   var bb = this.getBounds();\n                   var txt = JSON.stringify(bb);\n                   console.log(txt);\n\n                   setClipboardText('\\'' + txt + '\\'');\n               }\n           })\n        }).call(this.getMap(), el, x, data);\n}","data":null}]}}</script>
<p>point cloud data summary</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="sycmarsh.html#cb21-1" tabindex="-1"></a>aoi_las_ctg</span></code></pre></div>
<pre><code>## $SycanMarsh_als_2021
## class       : LAScatalog (v1.4 format 6)
## extent      : 651000, 653000, 4747000, 4748000 (xmin, xmax, ymin, ymax)
## coord. ref. : NAD83(2011) / UTM zone 10N + NAVD88 height - Geoid18 (m) 
## area        : 2 km²
## points      : 68.02 million points
## type        : airborne
## density     : 34 points/m²
## density     : 25.6 pulses/m²
## num. files  : 2 
## 
## $SycanMarsh_uas_lidar_2023
## class       : LAScatalog (v1.2 format 3)
## extent      : 651487, 652298.4, 4747227, 4747880 (xmin, xmax, ymin, ymax)
## coord. ref. : WGS 84 / UTM zone 10N 
## area        : 0.53 km²
## points      : 200.55 million points
## type        : terrestrial
## density     : 378.3 points/m²
## density     : 350.8 pulses/m²
## num. files  : 1</code></pre>
<div id="sy_als" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> ALS Processing<a href="sycmarsh.html#sy_als" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="itd-tuning" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> ITD tuning<a href="sycmarsh.html#itd-tuning" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>put las files in a list</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="sycmarsh.html#cb23-1" tabindex="-1"></a><span class="co"># list of all las files</span></span>
<span id="cb23-2"><a href="sycmarsh.html#cb23-2" tabindex="-1"></a>las_flist_temp <span class="ot">&lt;-</span> aoi_las_ctg[[<span class="st">&quot;SycanMarsh_als_2021&quot;</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb23-3"><a href="sycmarsh.html#cb23-3" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&quot;data&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb23-4"><a href="sycmarsh.html#cb23-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(filename)</span></code></pre></div>
<p>run tuning</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="sycmarsh.html#cb24-1" tabindex="-1"></a><span class="co"># if there is an error with tuning...is it because there are no trees for a given ws_fn?</span></span>
<span id="cb24-2"><a href="sycmarsh.html#cb24-2" tabindex="-1"></a>    <span class="co"># Caused by error in `dplyr::group_by()`:</span></span>
<span id="cb24-3"><a href="sycmarsh.html#cb24-3" tabindex="-1"></a>    <span class="co"># ! Must group by variables found in `.data`.</span></span>
<span id="cb24-4"><a href="sycmarsh.html#cb24-4" tabindex="-1"></a>    <span class="co"># Column `ws_fn` is not found.</span></span>
<span id="cb24-5"><a href="sycmarsh.html#cb24-5" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">&quot;../data/itd_tuning_SycanMarsh_als.jpg&quot;</span>)){</span>
<span id="cb24-6"><a href="sycmarsh.html#cb24-6" tabindex="-1"></a>  <span class="co"># tuning</span></span>
<span id="cb24-7"><a href="sycmarsh.html#cb24-7" tabindex="-1"></a>  itd_tuning_ans <span class="ot">&lt;-</span> cloud2trees<span class="sc">::</span><span class="fu">itd_tuning</span>(</span>
<span id="cb24-8"><a href="sycmarsh.html#cb24-8" tabindex="-1"></a>      <span class="at">input_las_dir =</span> las_flist_temp</span>
<span id="cb24-9"><a href="sycmarsh.html#cb24-9" tabindex="-1"></a>      , <span class="at">n_samples =</span> <span class="dv">2</span></span>
<span id="cb24-10"><a href="sycmarsh.html#cb24-10" tabindex="-1"></a>      , <span class="at">ws_fn_list =</span> my_ws_functions</span>
<span id="cb24-11"><a href="sycmarsh.html#cb24-11" tabindex="-1"></a>    )</span>
<span id="cb24-12"><a href="sycmarsh.html#cb24-12" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(</span>
<span id="cb24-13"><a href="sycmarsh.html#cb24-13" tabindex="-1"></a>    <span class="st">&quot;../data/itd_tuning_SycanMarsh_als.jpg&quot;</span></span>
<span id="cb24-14"><a href="sycmarsh.html#cb24-14" tabindex="-1"></a>    , <span class="at">plot =</span> itd_tuning_ans<span class="sc">$</span>plot_samples</span>
<span id="cb24-15"><a href="sycmarsh.html#cb24-15" tabindex="-1"></a>    , <span class="at">dpi =</span> <span class="st">&quot;print&quot;</span></span>
<span id="cb24-16"><a href="sycmarsh.html#cb24-16" tabindex="-1"></a>    , <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">10</span></span>
<span id="cb24-17"><a href="sycmarsh.html#cb24-17" tabindex="-1"></a>  )</span>
<span id="cb24-18"><a href="sycmarsh.html#cb24-18" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="https://i.ibb.co/VpqjxXSf/itd-tuning-Sycan-Marsh-als.jpg" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>pick the best function for use in ITD</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="sycmarsh.html#cb25-1" tabindex="-1"></a><span class="co"># pick the best function for use in ITD</span></span>
<span id="cb25-2"><a href="sycmarsh.html#cb25-2" tabindex="-1"></a>best_ws_fn_temp <span class="ot">&lt;-</span> my_ws_functions<span class="sc">$</span>exp_fn</span></code></pre></div>
</div>
<div id="cloud2trees-point-cloud-processing" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> <code>cloud2trees</code> point cloud processing<a href="sycmarsh.html#cloud2trees-point-cloud-processing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="sycmarsh.html#cb26-1" tabindex="-1"></a>dir_temp <span class="ot">&lt;-</span> <span class="fu">file.path</span>(aoi_sf<span class="sc">$</span>fdir, <span class="st">&quot;als_2021_processing&quot;</span>)</span>
<span id="cb26-2"><a href="sycmarsh.html#cb26-2" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(dir_temp)){</span>
<span id="cb26-3"><a href="sycmarsh.html#cb26-3" tabindex="-1"></a>  <span class="fu">dir.create</span>(dir_temp)</span>
<span id="cb26-4"><a href="sycmarsh.html#cb26-4" tabindex="-1"></a><span class="co"># c2t</span></span>
<span id="cb26-5"><a href="sycmarsh.html#cb26-5" tabindex="-1"></a>  cloud2trees_ans <span class="ot">&lt;-</span> cloud2trees<span class="sc">::</span><span class="fu">cloud2trees</span>(</span>
<span id="cb26-6"><a href="sycmarsh.html#cb26-6" tabindex="-1"></a>    <span class="at">input_las_dir =</span> las_flist_temp</span>
<span id="cb26-7"><a href="sycmarsh.html#cb26-7" tabindex="-1"></a>    , <span class="at">output_dir =</span> dir_temp</span>
<span id="cb26-8"><a href="sycmarsh.html#cb26-8" tabindex="-1"></a>    , <span class="at">ws =</span> best_ws_fn_temp</span>
<span id="cb26-9"><a href="sycmarsh.html#cb26-9" tabindex="-1"></a>    , <span class="at">dtm_res_m =</span> <span class="dv">1</span></span>
<span id="cb26-10"><a href="sycmarsh.html#cb26-10" tabindex="-1"></a>    , <span class="at">chm_res_m =</span> <span class="fl">0.25</span></span>
<span id="cb26-11"><a href="sycmarsh.html#cb26-11" tabindex="-1"></a>    , <span class="at">estimate_tree_dbh =</span> T</span>
<span id="cb26-12"><a href="sycmarsh.html#cb26-12" tabindex="-1"></a>    , <span class="at">estimate_tree_type =</span> T</span>
<span id="cb26-13"><a href="sycmarsh.html#cb26-13" tabindex="-1"></a>    <span class="co"># hmd</span></span>
<span id="cb26-14"><a href="sycmarsh.html#cb26-14" tabindex="-1"></a>    , <span class="at">estimate_tree_hmd =</span> T</span>
<span id="cb26-15"><a href="sycmarsh.html#cb26-15" tabindex="-1"></a>    , <span class="at">hmd_tree_sample_prop =</span> <span class="fl">0.5</span></span>
<span id="cb26-16"><a href="sycmarsh.html#cb26-16" tabindex="-1"></a>    , <span class="at">hmd_estimate_missing_hmd =</span> T</span>
<span id="cb26-17"><a href="sycmarsh.html#cb26-17" tabindex="-1"></a>    <span class="co"># biomass</span></span>
<span id="cb26-18"><a href="sycmarsh.html#cb26-18" tabindex="-1"></a>    , <span class="at">estimate_biomass_method =</span> <span class="fu">c</span>(<span class="st">&quot;landfire&quot;</span>,<span class="st">&quot;cruz&quot;</span>)</span>
<span id="cb26-19"><a href="sycmarsh.html#cb26-19" tabindex="-1"></a>    <span class="co"># cbh</span></span>
<span id="cb26-20"><a href="sycmarsh.html#cb26-20" tabindex="-1"></a>    , <span class="at">estimate_tree_cbh =</span> T</span>
<span id="cb26-21"><a href="sycmarsh.html#cb26-21" tabindex="-1"></a>    , <span class="at">cbh_tree_sample_prop =</span> <span class="fl">0.5</span></span>
<span id="cb26-22"><a href="sycmarsh.html#cb26-22" tabindex="-1"></a>    , <span class="at">cbh_estimate_missing_cbh =</span> T</span>
<span id="cb26-23"><a href="sycmarsh.html#cb26-23" tabindex="-1"></a>  )</span>
<span id="cb26-24"><a href="sycmarsh.html#cb26-24" tabindex="-1"></a>  <span class="co"># add foresttype</span></span>
<span id="cb26-25"><a href="sycmarsh.html#cb26-25" tabindex="-1"></a>  cloud2trees_ans<span class="sc">$</span>foresttype_rast <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>( <span class="fu">file.path</span>(dir_temp, <span class="st">&quot;point_cloud_processing_delivery&quot;</span>, <span class="st">&quot;fia_foresttype_raster.tif&quot;</span>) ) <span class="sc">%&gt;%</span> </span>
<span id="cb26-26"><a href="sycmarsh.html#cb26-26" tabindex="-1"></a>    terra<span class="sc">::</span><span class="fu">subst</span>(<span class="at">from =</span> foresttype_lookup<span class="sc">$</span>forest_type_group_code, <span class="at">to =</span> foresttype_lookup<span class="sc">$</span>forest_type_group)</span>
<span id="cb26-27"><a href="sycmarsh.html#cb26-27" tabindex="-1"></a>}<span class="cf">else</span>{</span>
<span id="cb26-28"><a href="sycmarsh.html#cb26-28" tabindex="-1"></a>  cloud2trees_ans <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb26-29"><a href="sycmarsh.html#cb26-29" tabindex="-1"></a>    <span class="st">&quot;dtm_rast&quot;</span> <span class="ot">=</span> terra<span class="sc">::</span><span class="fu">rast</span>( <span class="fu">file.path</span>(dir_temp, <span class="st">&quot;point_cloud_processing_delivery&quot;</span>, <span class="st">&quot;dtm_1m.tif&quot;</span>) )</span>
<span id="cb26-30"><a href="sycmarsh.html#cb26-30" tabindex="-1"></a>    , <span class="st">&quot;chm_rast&quot;</span> <span class="ot">=</span> terra<span class="sc">::</span><span class="fu">rast</span>( <span class="fu">file.path</span>(dir_temp, <span class="st">&quot;point_cloud_processing_delivery&quot;</span>, <span class="st">&quot;chm_0.25m.tif&quot;</span>) )</span>
<span id="cb26-31"><a href="sycmarsh.html#cb26-31" tabindex="-1"></a>    , <span class="st">&quot;crowns_sf&quot;</span> <span class="ot">=</span> <span class="fu">list.files</span>(</span>
<span id="cb26-32"><a href="sycmarsh.html#cb26-32" tabindex="-1"></a>        <span class="fu">file.path</span>(dir_temp, <span class="st">&quot;point_cloud_processing_delivery&quot;</span>)</span>
<span id="cb26-33"><a href="sycmarsh.html#cb26-33" tabindex="-1"></a>        , <span class="at">pattern =</span> <span class="st">&quot;final_detected_crowns.*</span><span class="sc">\\</span><span class="st">.gpkg$&quot;</span></span>
<span id="cb26-34"><a href="sycmarsh.html#cb26-34" tabindex="-1"></a>        , <span class="at">full.names =</span> T</span>
<span id="cb26-35"><a href="sycmarsh.html#cb26-35" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb26-36"><a href="sycmarsh.html#cb26-36" tabindex="-1"></a>      <span class="fu">normalizePath</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb26-37"><a href="sycmarsh.html#cb26-37" tabindex="-1"></a>      purrr<span class="sc">::</span><span class="fu">map</span>(\(x)</span>
<span id="cb26-38"><a href="sycmarsh.html#cb26-38" tabindex="-1"></a>        sf<span class="sc">::</span><span class="fu">st_read</span>(</span>
<span id="cb26-39"><a href="sycmarsh.html#cb26-39" tabindex="-1"></a>          <span class="at">dsn =</span> x</span>
<span id="cb26-40"><a href="sycmarsh.html#cb26-40" tabindex="-1"></a>          , <span class="at">quiet =</span> T</span>
<span id="cb26-41"><a href="sycmarsh.html#cb26-41" tabindex="-1"></a>        )</span>
<span id="cb26-42"><a href="sycmarsh.html#cb26-42" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb26-43"><a href="sycmarsh.html#cb26-43" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">bind_rows</span>()</span>
<span id="cb26-44"><a href="sycmarsh.html#cb26-44" tabindex="-1"></a>    , <span class="st">&quot;foresttype_rast&quot;</span> <span class="ot">=</span> terra<span class="sc">::</span><span class="fu">rast</span>( <span class="fu">file.path</span>(dir_temp, <span class="st">&quot;point_cloud_processing_delivery&quot;</span>, <span class="st">&quot;fia_foresttype_raster.tif&quot;</span>) ) <span class="sc">%&gt;%</span> </span>
<span id="cb26-45"><a href="sycmarsh.html#cb26-45" tabindex="-1"></a>        terra<span class="sc">::</span><span class="fu">subst</span>(<span class="at">from =</span> foresttype_lookup<span class="sc">$</span>forest_type_group_code, <span class="at">to =</span> foresttype_lookup<span class="sc">$</span>forest_type_group)</span>
<span id="cb26-46"><a href="sycmarsh.html#cb26-46" tabindex="-1"></a>  )</span>
<span id="cb26-47"><a href="sycmarsh.html#cb26-47" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="cloud2trees-results" class="section level3 hasAnchor" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> <code>cloud2trees</code> Results<a href="sycmarsh.html#cloud2trees-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="fia-forest-type-group" class="section level4 hasAnchor" number="3.1.3.1">
<h4><span class="header-section-number">3.1.3.1</span> FIA Forest Type Group<a href="sycmarsh.html#fia-forest-type-group" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="sycmarsh.html#cb27-1" tabindex="-1"></a><span class="co"># load raster</span></span>
<span id="cb27-2"><a href="sycmarsh.html#cb27-2" tabindex="-1"></a><span class="fu">plt_rast_poly_fn</span>(</span>
<span id="cb27-3"><a href="sycmarsh.html#cb27-3" tabindex="-1"></a>  <span class="at">rast =</span> cloud2trees_ans<span class="sc">$</span>foresttype_rast</span>
<span id="cb27-4"><a href="sycmarsh.html#cb27-4" tabindex="-1"></a>  , <span class="at">poly =</span> aoi_sf</span>
<span id="cb27-5"><a href="sycmarsh.html#cb27-5" tabindex="-1"></a>  , <span class="at">title =</span> <span class="st">&quot;FIA forest type group&quot;</span></span>
<span id="cb27-6"><a href="sycmarsh.html#cb27-6" tabindex="-1"></a>  , <span class="at">crop =</span> T</span>
<span id="cb27-7"><a href="sycmarsh.html#cb27-7" tabindex="-1"></a>  , <span class="at">buff =</span> <span class="dv">22</span></span>
<span id="cb27-8"><a href="sycmarsh.html#cb27-8" tabindex="-1"></a>  , <span class="at">col =</span> <span class="st">&quot;navy&quot;</span></span>
<span id="cb27-9"><a href="sycmarsh.html#cb27-9" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb27-10"><a href="sycmarsh.html#cb27-10" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;turbo&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb27-11"><a href="sycmarsh.html#cb27-11" tabindex="-1"></a>  <span class="co"># harrypotter::scale_fill_hp_d(option = &quot;lunalovegood&quot;, alpha = 0.8) +</span></span>
<span id="cb27-12"><a href="sycmarsh.html#cb27-12" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(aoi_sf<span class="sc">$</span>study_site_lab, <span class="st">&quot; - ALS&quot;</span>)) <span class="sc">+</span></span>
<span id="cb27-13"><a href="sycmarsh.html#cb27-13" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb27-14"><a href="sycmarsh.html#cb27-14" tabindex="-1"></a>    <span class="at">legend.text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">angle =</span> <span class="dv">0</span>)</span>
<span id="cb27-15"><a href="sycmarsh.html#cb27-15" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="dod_cloud2trees_demo_files/figure-html/unnamed-chunk-31-1.png" width="1008" /></p>
<p>distribution by forest type</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="sycmarsh.html#cb28-1" tabindex="-1"></a><span class="fu">foresttype_sum_fn</span>(<span class="at">crowns =</span> cloud2trees_ans<span class="sc">$</span>crowns_sf, <span class="at">aoi =</span> aoi_sf, <span class="at">unit =</span> aoi_sf<span class="sc">$</span>study_site_lab[<span class="dv">1</span>])</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-32">Table 3.1: </span>Count of trees by FIA Forest Type Group
</caption>
<thead>
<tr>
<th style="text-align:left;">
.
</th>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
# trees
</th>
<th style="text-align:left;">
% trees
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Sycan Marsh (OR)
</td>
<td style="text-align:left;">
Ponderosa pine group
</td>
<td style="text-align:left;">
4,205
</td>
<td style="text-align:left;">
100.0%
</td>
</tr>
</tbody>
</table>
</div>
<div id="dtm" class="section level4 hasAnchor" number="3.1.3.2">
<h4><span class="header-section-number">3.1.3.2</span> DTM<a href="sycmarsh.html#dtm" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="sycmarsh.html#cb29-1" tabindex="-1"></a><span class="fu">plt_rast_poly_fn</span>(</span>
<span id="cb29-2"><a href="sycmarsh.html#cb29-2" tabindex="-1"></a>  <span class="at">rast =</span> cloud2trees_ans<span class="sc">$</span>dtm_rast</span>
<span id="cb29-3"><a href="sycmarsh.html#cb29-3" tabindex="-1"></a>  , <span class="at">poly =</span> aoi_sf</span>
<span id="cb29-4"><a href="sycmarsh.html#cb29-4" tabindex="-1"></a>  , <span class="at">title =</span> <span class="st">&quot;DTM (m)&quot;</span></span>
<span id="cb29-5"><a href="sycmarsh.html#cb29-5" tabindex="-1"></a>  , <span class="at">crop =</span> T</span>
<span id="cb29-6"><a href="sycmarsh.html#cb29-6" tabindex="-1"></a>  , <span class="at">buff =</span> <span class="dv">22</span></span>
<span id="cb29-7"><a href="sycmarsh.html#cb29-7" tabindex="-1"></a>  , <span class="at">col =</span> <span class="st">&quot;navy&quot;</span></span>
<span id="cb29-8"><a href="sycmarsh.html#cb29-8" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb29-9"><a href="sycmarsh.html#cb29-9" tabindex="-1"></a>  harrypotter<span class="sc">::</span><span class="fu">scale_fill_hp</span>(</span>
<span id="cb29-10"><a href="sycmarsh.html#cb29-10" tabindex="-1"></a>    <span class="at">option =</span> <span class="st">&quot;mischief&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>, <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>(<span class="at">accuracy=</span><span class="dv">1</span>), <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">breaks_extended</span>(<span class="at">n=</span><span class="dv">6</span>)</span>
<span id="cb29-11"><a href="sycmarsh.html#cb29-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-12"><a href="sycmarsh.html#cb29-12" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(aoi_sf<span class="sc">$</span>study_site_lab, <span class="st">&quot; - ALS&quot;</span>))</span></code></pre></div>
<p><img src="dod_cloud2trees_demo_files/figure-html/unnamed-chunk-33-1.png" width="1008" /></p>
</div>
<div id="chm" class="section level4 hasAnchor" number="3.1.3.3">
<h4><span class="header-section-number">3.1.3.3</span> CHM<a href="sycmarsh.html#chm" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>plot the CHM and we’ll also add the extracted trees in gray</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="sycmarsh.html#cb30-1" tabindex="-1"></a><span class="fu">plt_rast_poly_fn</span>(</span>
<span id="cb30-2"><a href="sycmarsh.html#cb30-2" tabindex="-1"></a>  <span class="at">rast =</span> cloud2trees_ans<span class="sc">$</span>chm_rast</span>
<span id="cb30-3"><a href="sycmarsh.html#cb30-3" tabindex="-1"></a>  , <span class="at">poly =</span> aoi_sf</span>
<span id="cb30-4"><a href="sycmarsh.html#cb30-4" tabindex="-1"></a>  , <span class="at">title =</span> <span class="st">&quot;CHM (m)&quot;</span></span>
<span id="cb30-5"><a href="sycmarsh.html#cb30-5" tabindex="-1"></a>  , <span class="at">crop =</span> T</span>
<span id="cb30-6"><a href="sycmarsh.html#cb30-6" tabindex="-1"></a>  , <span class="at">buff =</span> <span class="dv">22</span></span>
<span id="cb30-7"><a href="sycmarsh.html#cb30-7" tabindex="-1"></a>  , <span class="at">col =</span> <span class="st">&quot;navy&quot;</span></span>
<span id="cb30-8"><a href="sycmarsh.html#cb30-8" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb30-9"><a href="sycmarsh.html#cb30-9" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_viridis_c</span>(</span>
<span id="cb30-10"><a href="sycmarsh.html#cb30-10" tabindex="-1"></a>    <span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>, <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>(<span class="at">accuracy=</span><span class="dv">1</span>), <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">breaks_extended</span>(<span class="at">n=</span><span class="dv">6</span>)</span>
<span id="cb30-11"><a href="sycmarsh.html#cb30-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb30-12"><a href="sycmarsh.html#cb30-12" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_sf</span>(</span>
<span id="cb30-13"><a href="sycmarsh.html#cb30-13" tabindex="-1"></a>    <span class="at">data =</span> cloud2trees_ans<span class="sc">$</span>crowns_sf <span class="sc">%&gt;%</span> </span>
<span id="cb30-14"><a href="sycmarsh.html#cb30-14" tabindex="-1"></a>      <span class="co"># dplyr::slice_sample(prop = 0.1) %&gt;% </span></span>
<span id="cb30-15"><a href="sycmarsh.html#cb30-15" tabindex="-1"></a>      sf<span class="sc">::</span><span class="fu">st_intersection</span>(</span>
<span id="cb30-16"><a href="sycmarsh.html#cb30-16" tabindex="-1"></a>        aoi_sf <span class="sc">%&gt;%</span> sf<span class="sc">::</span><span class="fu">st_transform</span>(sf<span class="sc">::</span><span class="fu">st_crs</span>(cloud2trees_ans<span class="sc">$</span>crowns_sf))</span>
<span id="cb30-17"><a href="sycmarsh.html#cb30-17" tabindex="-1"></a>      )</span>
<span id="cb30-18"><a href="sycmarsh.html#cb30-18" tabindex="-1"></a>    , <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">&quot;gray33&quot;</span>, <span class="at">lwd =</span> <span class="fl">0.5</span></span>
<span id="cb30-19"><a href="sycmarsh.html#cb30-19" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb30-20"><a href="sycmarsh.html#cb30-20" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(aoi_sf<span class="sc">$</span>study_site_lab, <span class="st">&quot; - ALS&quot;</span>))</span></code></pre></div>
<p><img src="dod_cloud2trees_demo_files/figure-html/unnamed-chunk-34-1.png" width="1008" /></p>
</div>
<div id="imagery" class="section level4 hasAnchor" number="3.1.3.4">
<h4><span class="header-section-number">3.1.3.4</span> Imagery<a href="sycmarsh.html#imagery" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>let’s check the tree extraction results (gray) on satellite imagery with a collection date that may not coincide with the point cloud collection date</p>
<p><em>we’ll sample the trees here so the output can be seen more clearly</em></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="sycmarsh.html#cb31-1" tabindex="-1"></a>plt_aoi_basemap <span class="ot">&lt;-</span> <span class="fu">my_ggmap_basemap</span>(</span>
<span id="cb31-2"><a href="sycmarsh.html#cb31-2" tabindex="-1"></a>  <span class="at">sf_data =</span> aoi_sf</span>
<span id="cb31-3"><a href="sycmarsh.html#cb31-3" tabindex="-1"></a>  , <span class="at">zoom_level =</span> <span class="dv">16</span></span>
<span id="cb31-4"><a href="sycmarsh.html#cb31-4" tabindex="-1"></a>  , <span class="at">buffer_box =</span> <span class="dv">22</span></span>
<span id="cb31-5"><a href="sycmarsh.html#cb31-5" tabindex="-1"></a>  , <span class="at">my_maptype =</span> <span class="st">&quot;satellite&quot;</span></span>
<span id="cb31-6"><a href="sycmarsh.html#cb31-6" tabindex="-1"></a>  , <span class="at">add_sf_data =</span> T</span>
<span id="cb31-7"><a href="sycmarsh.html#cb31-7" tabindex="-1"></a>  , <span class="at">outline_sf_data_col =</span> <span class="st">&quot;navy&quot;</span></span>
<span id="cb31-8"><a href="sycmarsh.html#cb31-8" tabindex="-1"></a>  , <span class="at">outline_lwd =</span> <span class="dv">1</span></span>
<span id="cb31-9"><a href="sycmarsh.html#cb31-9" tabindex="-1"></a>)</span>
<span id="cb31-10"><a href="sycmarsh.html#cb31-10" tabindex="-1"></a><span class="co"># add crowns</span></span>
<span id="cb31-11"><a href="sycmarsh.html#cb31-11" tabindex="-1"></a>plt_aoi_basemap <span class="sc">+</span></span>
<span id="cb31-12"><a href="sycmarsh.html#cb31-12" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_sf</span>(</span>
<span id="cb31-13"><a href="sycmarsh.html#cb31-13" tabindex="-1"></a>    <span class="at">data =</span> cloud2trees_ans<span class="sc">$</span>crowns_sf <span class="sc">%&gt;%</span> </span>
<span id="cb31-14"><a href="sycmarsh.html#cb31-14" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">prop =</span> <span class="fl">0.6</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-15"><a href="sycmarsh.html#cb31-15" tabindex="-1"></a>      sf<span class="sc">::</span><span class="fu">st_intersection</span>(</span>
<span id="cb31-16"><a href="sycmarsh.html#cb31-16" tabindex="-1"></a>        aoi_sf <span class="sc">%&gt;%</span> sf<span class="sc">::</span><span class="fu">st_transform</span>(sf<span class="sc">::</span><span class="fu">st_crs</span>(cloud2trees_ans<span class="sc">$</span>crowns_sf))</span>
<span id="cb31-17"><a href="sycmarsh.html#cb31-17" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb31-18"><a href="sycmarsh.html#cb31-18" tabindex="-1"></a>      sf<span class="sc">::</span><span class="fu">st_transform</span>(<span class="dv">4326</span>)</span>
<span id="cb31-19"><a href="sycmarsh.html#cb31-19" tabindex="-1"></a>    , <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">&quot;gray77&quot;</span>, <span class="at">lwd =</span> <span class="fl">0.1</span></span>
<span id="cb31-20"><a href="sycmarsh.html#cb31-20" tabindex="-1"></a>    , <span class="at">inherit.aes =</span> F</span>
<span id="cb31-21"><a href="sycmarsh.html#cb31-21" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb31-22"><a href="sycmarsh.html#cb31-22" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(aoi_sf<span class="sc">$</span>study_site_lab, <span class="st">&quot; - ALS&quot;</span>)) <span class="sc">+</span></span>
<span id="cb31-23"><a href="sycmarsh.html#cb31-23" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb31-24"><a href="sycmarsh.html#cb31-24" tabindex="-1"></a>    <span class="at">plot.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">0</span>))</span>
<span id="cb31-25"><a href="sycmarsh.html#cb31-25" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="dod_cloud2trees_demo_files/figure-html/unnamed-chunk-35-1.png" width="1008" /></p>
</div>
<div id="tree-attributes-spatial" class="section level4 hasAnchor" number="3.1.3.5">
<h4><span class="header-section-number">3.1.3.5</span> Tree Attributes Spatial<a href="sycmarsh.html#tree-attributes-spatial" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="sycmarsh.html#cb32-1" tabindex="-1"></a>plt_df_temp <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb32-2"><a href="sycmarsh.html#cb32-2" tabindex="-1"></a>  <span class="at">fill_var =</span> <span class="fu">c</span>(<span class="st">&quot;tree_height_m&quot;</span>, <span class="st">&quot;dbh_cm&quot;</span>, <span class="st">&quot;tree_cbh_m&quot;</span>, <span class="st">&quot;max_crown_diam_height_m&quot;</span>, <span class="st">&quot;landfire_crown_biomass_kg&quot;</span>)</span>
<span id="cb32-3"><a href="sycmarsh.html#cb32-3" tabindex="-1"></a>  , <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;Blues&quot;</span>, <span class="st">&quot;Oranges&quot;</span>, <span class="st">&quot;Greens&quot;</span>, <span class="st">&quot;Purples&quot;</span>, <span class="st">&quot;Reds&quot;</span>)</span>
<span id="cb32-4"><a href="sycmarsh.html#cb32-4" tabindex="-1"></a>  , <span class="at">title =</span> <span class="fu">c</span>(<span class="st">&quot;Height (m)&quot;</span>, <span class="st">&quot;DBH (cm)&quot;</span>, <span class="st">&quot;CBH (m)&quot;</span>, <span class="st">&quot;HMD (m)&quot;</span>, <span class="st">&quot;Crown</span><span class="sc">\n</span><span class="st">biomass (kg)&quot;</span>)</span>
<span id="cb32-5"><a href="sycmarsh.html#cb32-5" tabindex="-1"></a>)</span>
<span id="cb32-6"><a href="sycmarsh.html#cb32-6" tabindex="-1"></a></span>
<span id="cb32-7"><a href="sycmarsh.html#cb32-7" tabindex="-1"></a>plts_temp <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(plt_df_temp) <span class="sc">%&gt;%</span> </span>
<span id="cb32-8"><a href="sycmarsh.html#cb32-8" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(</span>
<span id="cb32-9"><a href="sycmarsh.html#cb32-9" tabindex="-1"></a>    \(x)</span>
<span id="cb32-10"><a href="sycmarsh.html#cb32-10" tabindex="-1"></a>    <span class="fu">plt_crown_attr_fn</span>(</span>
<span id="cb32-11"><a href="sycmarsh.html#cb32-11" tabindex="-1"></a>      <span class="at">crowns =</span> cloud2trees_ans<span class="sc">$</span>crowns_sf</span>
<span id="cb32-12"><a href="sycmarsh.html#cb32-12" tabindex="-1"></a>      , <span class="at">aoi =</span> aoi_sf</span>
<span id="cb32-13"><a href="sycmarsh.html#cb32-13" tabindex="-1"></a>      , <span class="at">lwd =</span> <span class="fl">0.6</span></span>
<span id="cb32-14"><a href="sycmarsh.html#cb32-14" tabindex="-1"></a>      , <span class="at">fill_var =</span> plt_df_temp<span class="sc">$</span>fill_var[x]</span>
<span id="cb32-15"><a href="sycmarsh.html#cb32-15" tabindex="-1"></a>      , <span class="at">palette =</span> plt_df_temp<span class="sc">$</span>palette[x]</span>
<span id="cb32-16"><a href="sycmarsh.html#cb32-16" tabindex="-1"></a>      , <span class="at">title =</span> plt_df_temp<span class="sc">$</span>title[x]</span>
<span id="cb32-17"><a href="sycmarsh.html#cb32-17" tabindex="-1"></a>    )  </span>
<span id="cb32-18"><a href="sycmarsh.html#cb32-18" tabindex="-1"></a>  )</span>
<span id="cb32-19"><a href="sycmarsh.html#cb32-19" tabindex="-1"></a><span class="co"># combine with patchwork</span></span>
<span id="cb32-20"><a href="sycmarsh.html#cb32-20" tabindex="-1"></a>patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(plts_temp, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb32-21"><a href="sycmarsh.html#cb32-21" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(</span>
<span id="cb32-22"><a href="sycmarsh.html#cb32-22" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">paste0</span>(aoi_sf<span class="sc">$</span>study_site_lab, <span class="st">&quot; - ALS&quot;</span>)</span>
<span id="cb32-23"><a href="sycmarsh.html#cb32-23" tabindex="-1"></a>    <span class="co"># , subtitle = &quot;huh&quot;</span></span>
<span id="cb32-24"><a href="sycmarsh.html#cb32-24" tabindex="-1"></a>    <span class="co"># , caption = &quot;hey&quot;</span></span>
<span id="cb32-25"><a href="sycmarsh.html#cb32-25" tabindex="-1"></a>    , <span class="at">theme =</span> ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb32-26"><a href="sycmarsh.html#cb32-26" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>))</span>
<span id="cb32-27"><a href="sycmarsh.html#cb32-27" tabindex="-1"></a>    )</span>
<span id="cb32-28"><a href="sycmarsh.html#cb32-28" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="dod_cloud2trees_demo_files/figure-html/unnamed-chunk-36-1.png" width="1008" /></p>
</div>
<div id="tree-attributes-summary-stats" class="section level4 hasAnchor" number="3.1.3.6">
<h4><span class="header-section-number">3.1.3.6</span> Tree Attributes Summary Stats<a href="sycmarsh.html#tree-attributes-summary-stats" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="sycmarsh.html#cb33-1" tabindex="-1"></a><span class="fu">stats_sum_fn</span>(<span class="at">crowns =</span> cloud2trees_ans<span class="sc">$</span>crowns_sf, <span class="at">aoi =</span> aoi_sf, <span class="at">unit =</span> <span class="fu">paste0</span>(aoi_sf<span class="sc">$</span>study_site_lab, <span class="st">&quot; - ALS&quot;</span>))</span></code></pre></div>
<table class="table" style="font-size: 13px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-37">Table 3.2: </span>Summary statistics for selected metrics
</caption>
<thead>
<tr>
<th style="text-align:left;">
Unit Name
</th>
<th style="text-align:left;">
Metric
</th>
<th style="text-align:left;">
Mean
</th>
<th style="text-align:left;">
Median
</th>
<th style="text-align:left;">
Std Dev
</th>
<th style="text-align:left;">
Range
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="6">
Sycan Marsh (OR) - ALS<br>(4,205 trees)
</td>
<td style="text-align:left;">
Height (m)
</td>
<td style="text-align:left;">
12.7
</td>
<td style="text-align:left;">
12.8
</td>
<td style="text-align:left;">
6.1
</td>
<td style="text-align:left;">
2.0—33.8
</td>
</tr>
<tr>
<td style="text-align:left;">
DBH (cm)
</td>
<td style="text-align:left;">
24.2
</td>
<td style="text-align:left;">
23.1
</td>
<td style="text-align:left;">
13.8
</td>
<td style="text-align:left;">
3.6—79.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Crown Base Ht. (m)
</td>
<td style="text-align:left;">
3.8
</td>
<td style="text-align:left;">
3.8
</td>
<td style="text-align:left;">
1.1
</td>
<td style="text-align:left;">
1.5—15.5
</td>
</tr>
<tr>
<td style="text-align:left;">
HMD (m)
</td>
<td style="text-align:left;">
5.3
</td>
<td style="text-align:left;">
5.5
</td>
<td style="text-align:left;">
1.8
</td>
<td style="text-align:left;">
0.0—18.5
</td>
</tr>
<tr>
<td style="text-align:left;">
Cruz CBD<br>kg m<sup>-3</sup>
</td>
<td style="text-align:left;">
0.420
</td>
<td style="text-align:left;">
0.414
</td>
<td style="text-align:left;">
0.116
</td>
<td style="text-align:left;">
0.107—1.253
</td>
</tr>
<tr>
<td style="text-align:left;">
LANDFIRE CBD<br>kg m<sup>-3</sup>
</td>
<td style="text-align:left;">
0.217
</td>
<td style="text-align:left;">
0.200
</td>
<td style="text-align:left;">
0.131
</td>
<td style="text-align:left;">
0.097—1.953
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="sy_uas" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> UAS lidar Processing<a href="sycmarsh.html#sy_uas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="itd-tuning-1" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> ITD tuning<a href="sycmarsh.html#itd-tuning-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>put las files in a list</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="sycmarsh.html#cb34-1" tabindex="-1"></a><span class="co"># list of all las files</span></span>
<span id="cb34-2"><a href="sycmarsh.html#cb34-2" tabindex="-1"></a>las_flist_temp <span class="ot">&lt;-</span> aoi_las_ctg[[<span class="st">&quot;SycanMarsh_uas_lidar_2023&quot;</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb34-3"><a href="sycmarsh.html#cb34-3" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&quot;data&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb34-4"><a href="sycmarsh.html#cb34-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(filename)</span></code></pre></div>
<p>run tuning</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="sycmarsh.html#cb35-1" tabindex="-1"></a><span class="co"># if there is an error with tuning...is it because there are no trees for a given ws_fn?</span></span>
<span id="cb35-2"><a href="sycmarsh.html#cb35-2" tabindex="-1"></a>    <span class="co"># Caused by error in `dplyr::group_by()`:</span></span>
<span id="cb35-3"><a href="sycmarsh.html#cb35-3" tabindex="-1"></a>    <span class="co"># ! Must group by variables found in `.data`.</span></span>
<span id="cb35-4"><a href="sycmarsh.html#cb35-4" tabindex="-1"></a>    <span class="co"># Column `ws_fn` is not found.</span></span>
<span id="cb35-5"><a href="sycmarsh.html#cb35-5" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">&quot;../data/itd_tuning_SycanMarsh_uas_lidar.jpg&quot;</span>)){</span>
<span id="cb35-6"><a href="sycmarsh.html#cb35-6" tabindex="-1"></a>  <span class="co"># tuning</span></span>
<span id="cb35-7"><a href="sycmarsh.html#cb35-7" tabindex="-1"></a>  itd_tuning_ans <span class="ot">&lt;-</span> cloud2trees<span class="sc">::</span><span class="fu">itd_tuning</span>(</span>
<span id="cb35-8"><a href="sycmarsh.html#cb35-8" tabindex="-1"></a>      <span class="at">input_las_dir =</span> las_flist_temp</span>
<span id="cb35-9"><a href="sycmarsh.html#cb35-9" tabindex="-1"></a>      , <span class="at">n_samples =</span> <span class="dv">2</span></span>
<span id="cb35-10"><a href="sycmarsh.html#cb35-10" tabindex="-1"></a>      , <span class="at">ws_fn_list =</span> my_ws_functions</span>
<span id="cb35-11"><a href="sycmarsh.html#cb35-11" tabindex="-1"></a>    )</span>
<span id="cb35-12"><a href="sycmarsh.html#cb35-12" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(</span>
<span id="cb35-13"><a href="sycmarsh.html#cb35-13" tabindex="-1"></a>    <span class="st">&quot;../data/itd_tuning_SycanMarsh_uas_lidar.jpg&quot;</span></span>
<span id="cb35-14"><a href="sycmarsh.html#cb35-14" tabindex="-1"></a>    , <span class="at">plot =</span> itd_tuning_ans<span class="sc">$</span>plot_samples</span>
<span id="cb35-15"><a href="sycmarsh.html#cb35-15" tabindex="-1"></a>    , <span class="at">dpi =</span> <span class="st">&quot;print&quot;</span></span>
<span id="cb35-16"><a href="sycmarsh.html#cb35-16" tabindex="-1"></a>    , <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">10</span></span>
<span id="cb35-17"><a href="sycmarsh.html#cb35-17" tabindex="-1"></a>  )</span>
<span id="cb35-18"><a href="sycmarsh.html#cb35-18" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="https://i.ibb.co/mdBgNsv/itd-tuning-Sycan-Marsh-uas-lidar.jpg" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>pick the best function for use in ITD</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="sycmarsh.html#cb36-1" tabindex="-1"></a><span class="co"># pick the best function for use in ITD</span></span>
<span id="cb36-2"><a href="sycmarsh.html#cb36-2" tabindex="-1"></a>best_ws_fn_temp <span class="ot">&lt;-</span> my_ws_functions<span class="sc">$</span>lin_fn</span></code></pre></div>
</div>
<div id="cloud2trees-point-cloud-processing-1" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> <code>cloud2trees</code> point cloud processing<a href="sycmarsh.html#cloud2trees-point-cloud-processing-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="sycmarsh.html#cb37-1" tabindex="-1"></a>dir_temp <span class="ot">&lt;-</span> <span class="fu">file.path</span>(aoi_sf<span class="sc">$</span>fdir, <span class="st">&quot;uas_lidar_2023_processing&quot;</span>)</span>
<span id="cb37-2"><a href="sycmarsh.html#cb37-2" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(dir_temp)){</span>
<span id="cb37-3"><a href="sycmarsh.html#cb37-3" tabindex="-1"></a>  <span class="fu">dir.create</span>(dir_temp)</span>
<span id="cb37-4"><a href="sycmarsh.html#cb37-4" tabindex="-1"></a><span class="co"># c2t</span></span>
<span id="cb37-5"><a href="sycmarsh.html#cb37-5" tabindex="-1"></a>  cloud2trees_ans <span class="ot">&lt;-</span> cloud2trees<span class="sc">::</span><span class="fu">cloud2trees</span>(</span>
<span id="cb37-6"><a href="sycmarsh.html#cb37-6" tabindex="-1"></a>    <span class="at">input_las_dir =</span> las_flist_temp</span>
<span id="cb37-7"><a href="sycmarsh.html#cb37-7" tabindex="-1"></a>    , <span class="at">output_dir =</span> dir_temp</span>
<span id="cb37-8"><a href="sycmarsh.html#cb37-8" tabindex="-1"></a>    , <span class="at">ws =</span> best_ws_fn_temp</span>
<span id="cb37-9"><a href="sycmarsh.html#cb37-9" tabindex="-1"></a>    , <span class="at">dtm_res_m =</span> <span class="dv">1</span></span>
<span id="cb37-10"><a href="sycmarsh.html#cb37-10" tabindex="-1"></a>    , <span class="at">chm_res_m =</span> <span class="fl">0.25</span></span>
<span id="cb37-11"><a href="sycmarsh.html#cb37-11" tabindex="-1"></a>    , <span class="at">estimate_tree_dbh =</span> T</span>
<span id="cb37-12"><a href="sycmarsh.html#cb37-12" tabindex="-1"></a>    , <span class="at">estimate_tree_type =</span> T</span>
<span id="cb37-13"><a href="sycmarsh.html#cb37-13" tabindex="-1"></a>    <span class="co"># hmd</span></span>
<span id="cb37-14"><a href="sycmarsh.html#cb37-14" tabindex="-1"></a>    , <span class="at">estimate_tree_hmd =</span> T</span>
<span id="cb37-15"><a href="sycmarsh.html#cb37-15" tabindex="-1"></a>    , <span class="at">hmd_tree_sample_prop =</span> <span class="fl">0.5</span></span>
<span id="cb37-16"><a href="sycmarsh.html#cb37-16" tabindex="-1"></a>    , <span class="at">hmd_estimate_missing_hmd =</span> T</span>
<span id="cb37-17"><a href="sycmarsh.html#cb37-17" tabindex="-1"></a>    <span class="co"># biomass</span></span>
<span id="cb37-18"><a href="sycmarsh.html#cb37-18" tabindex="-1"></a>    , <span class="at">estimate_biomass_method =</span> <span class="fu">c</span>(<span class="st">&quot;landfire&quot;</span>,<span class="st">&quot;cruz&quot;</span>)</span>
<span id="cb37-19"><a href="sycmarsh.html#cb37-19" tabindex="-1"></a>    <span class="co"># cbh</span></span>
<span id="cb37-20"><a href="sycmarsh.html#cb37-20" tabindex="-1"></a>    , <span class="at">estimate_tree_cbh =</span> T</span>
<span id="cb37-21"><a href="sycmarsh.html#cb37-21" tabindex="-1"></a>    , <span class="at">cbh_tree_sample_prop =</span> <span class="fl">0.5</span></span>
<span id="cb37-22"><a href="sycmarsh.html#cb37-22" tabindex="-1"></a>    , <span class="at">cbh_estimate_missing_cbh =</span> T</span>
<span id="cb37-23"><a href="sycmarsh.html#cb37-23" tabindex="-1"></a>  )</span>
<span id="cb37-24"><a href="sycmarsh.html#cb37-24" tabindex="-1"></a>  <span class="co"># add foresttype</span></span>
<span id="cb37-25"><a href="sycmarsh.html#cb37-25" tabindex="-1"></a>  cloud2trees_ans<span class="sc">$</span>foresttype_rast <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>( <span class="fu">file.path</span>(dir_temp, <span class="st">&quot;point_cloud_processing_delivery&quot;</span>, <span class="st">&quot;fia_foresttype_raster.tif&quot;</span>) ) <span class="sc">%&gt;%</span> </span>
<span id="cb37-26"><a href="sycmarsh.html#cb37-26" tabindex="-1"></a>    terra<span class="sc">::</span><span class="fu">subst</span>(<span class="at">from =</span> foresttype_lookup<span class="sc">$</span>forest_type_group_code, <span class="at">to =</span> foresttype_lookup<span class="sc">$</span>forest_type_group)</span>
<span id="cb37-27"><a href="sycmarsh.html#cb37-27" tabindex="-1"></a>}<span class="cf">else</span>{</span>
<span id="cb37-28"><a href="sycmarsh.html#cb37-28" tabindex="-1"></a>  cloud2trees_ans <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb37-29"><a href="sycmarsh.html#cb37-29" tabindex="-1"></a>    <span class="st">&quot;dtm_rast&quot;</span> <span class="ot">=</span> terra<span class="sc">::</span><span class="fu">rast</span>( <span class="fu">file.path</span>(dir_temp, <span class="st">&quot;point_cloud_processing_delivery&quot;</span>, <span class="st">&quot;dtm_1m.tif&quot;</span>) )</span>
<span id="cb37-30"><a href="sycmarsh.html#cb37-30" tabindex="-1"></a>    , <span class="st">&quot;chm_rast&quot;</span> <span class="ot">=</span> terra<span class="sc">::</span><span class="fu">rast</span>( <span class="fu">file.path</span>(dir_temp, <span class="st">&quot;point_cloud_processing_delivery&quot;</span>, <span class="st">&quot;chm_0.25m.tif&quot;</span>) )</span>
<span id="cb37-31"><a href="sycmarsh.html#cb37-31" tabindex="-1"></a>    , <span class="st">&quot;crowns_sf&quot;</span> <span class="ot">=</span> <span class="fu">list.files</span>(</span>
<span id="cb37-32"><a href="sycmarsh.html#cb37-32" tabindex="-1"></a>        <span class="fu">file.path</span>(dir_temp, <span class="st">&quot;point_cloud_processing_delivery&quot;</span>)</span>
<span id="cb37-33"><a href="sycmarsh.html#cb37-33" tabindex="-1"></a>        , <span class="at">pattern =</span> <span class="st">&quot;final_detected_crowns.*</span><span class="sc">\\</span><span class="st">.gpkg$&quot;</span></span>
<span id="cb37-34"><a href="sycmarsh.html#cb37-34" tabindex="-1"></a>        , <span class="at">full.names =</span> T</span>
<span id="cb37-35"><a href="sycmarsh.html#cb37-35" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb37-36"><a href="sycmarsh.html#cb37-36" tabindex="-1"></a>      <span class="fu">normalizePath</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb37-37"><a href="sycmarsh.html#cb37-37" tabindex="-1"></a>      purrr<span class="sc">::</span><span class="fu">map</span>(\(x)</span>
<span id="cb37-38"><a href="sycmarsh.html#cb37-38" tabindex="-1"></a>        sf<span class="sc">::</span><span class="fu">st_read</span>(</span>
<span id="cb37-39"><a href="sycmarsh.html#cb37-39" tabindex="-1"></a>          <span class="at">dsn =</span> x</span>
<span id="cb37-40"><a href="sycmarsh.html#cb37-40" tabindex="-1"></a>          , <span class="at">quiet =</span> T</span>
<span id="cb37-41"><a href="sycmarsh.html#cb37-41" tabindex="-1"></a>        )</span>
<span id="cb37-42"><a href="sycmarsh.html#cb37-42" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb37-43"><a href="sycmarsh.html#cb37-43" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">bind_rows</span>()</span>
<span id="cb37-44"><a href="sycmarsh.html#cb37-44" tabindex="-1"></a>    , <span class="st">&quot;foresttype_rast&quot;</span> <span class="ot">=</span> terra<span class="sc">::</span><span class="fu">rast</span>( <span class="fu">file.path</span>(dir_temp, <span class="st">&quot;point_cloud_processing_delivery&quot;</span>, <span class="st">&quot;fia_foresttype_raster.tif&quot;</span>) ) <span class="sc">%&gt;%</span> </span>
<span id="cb37-45"><a href="sycmarsh.html#cb37-45" tabindex="-1"></a>        terra<span class="sc">::</span><span class="fu">subst</span>(<span class="at">from =</span> foresttype_lookup<span class="sc">$</span>forest_type_group_code, <span class="at">to =</span> foresttype_lookup<span class="sc">$</span>forest_type_group)</span>
<span id="cb37-46"><a href="sycmarsh.html#cb37-46" tabindex="-1"></a>  )</span>
<span id="cb37-47"><a href="sycmarsh.html#cb37-47" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="cloud2trees-results-1" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> <code>cloud2trees</code> Results<a href="sycmarsh.html#cloud2trees-results-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="fia-forest-type-group-1" class="section level4 hasAnchor" number="3.2.3.1">
<h4><span class="header-section-number">3.2.3.1</span> FIA Forest Type Group<a href="sycmarsh.html#fia-forest-type-group-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="sycmarsh.html#cb38-1" tabindex="-1"></a><span class="co"># load raster</span></span>
<span id="cb38-2"><a href="sycmarsh.html#cb38-2" tabindex="-1"></a><span class="fu">plt_rast_poly_fn</span>(</span>
<span id="cb38-3"><a href="sycmarsh.html#cb38-3" tabindex="-1"></a>  <span class="at">rast =</span> cloud2trees_ans<span class="sc">$</span>foresttype_rast</span>
<span id="cb38-4"><a href="sycmarsh.html#cb38-4" tabindex="-1"></a>  , <span class="at">poly =</span> aoi_sf</span>
<span id="cb38-5"><a href="sycmarsh.html#cb38-5" tabindex="-1"></a>  , <span class="at">title =</span> <span class="st">&quot;FIA forest type group&quot;</span></span>
<span id="cb38-6"><a href="sycmarsh.html#cb38-6" tabindex="-1"></a>  , <span class="at">crop =</span> T</span>
<span id="cb38-7"><a href="sycmarsh.html#cb38-7" tabindex="-1"></a>  , <span class="at">buff =</span> <span class="dv">22</span></span>
<span id="cb38-8"><a href="sycmarsh.html#cb38-8" tabindex="-1"></a>  , <span class="at">col =</span> <span class="st">&quot;navy&quot;</span></span>
<span id="cb38-9"><a href="sycmarsh.html#cb38-9" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb38-10"><a href="sycmarsh.html#cb38-10" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;turbo&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb38-11"><a href="sycmarsh.html#cb38-11" tabindex="-1"></a>  <span class="co"># harrypotter::scale_fill_hp_d(option = &quot;lunalovegood&quot;, alpha = 0.8) +</span></span>
<span id="cb38-12"><a href="sycmarsh.html#cb38-12" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(aoi_sf<span class="sc">$</span>study_site_lab, <span class="st">&quot; - UAS Lidar&quot;</span>)) <span class="sc">+</span></span>
<span id="cb38-13"><a href="sycmarsh.html#cb38-13" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb38-14"><a href="sycmarsh.html#cb38-14" tabindex="-1"></a>    <span class="at">legend.text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">angle =</span> <span class="dv">0</span>)</span>
<span id="cb38-15"><a href="sycmarsh.html#cb38-15" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="dod_cloud2trees_demo_files/figure-html/unnamed-chunk-44-1.png" width="1008" /></p>
<p>distribution by forest type</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="sycmarsh.html#cb39-1" tabindex="-1"></a><span class="fu">foresttype_sum_fn</span>(<span class="at">crowns =</span> cloud2trees_ans<span class="sc">$</span>crowns_sf, <span class="at">aoi =</span> aoi_sf, <span class="at">unit =</span> aoi_sf<span class="sc">$</span>study_site_lab[<span class="dv">1</span>])</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-45">Table 3.3: </span>Count of trees by FIA Forest Type Group
</caption>
<thead>
<tr>
<th style="text-align:left;">
.
</th>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
# trees
</th>
<th style="text-align:left;">
% trees
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Sycan Marsh (OR)
</td>
<td style="text-align:left;">
Ponderosa pine group
</td>
<td style="text-align:left;">
4,435
</td>
<td style="text-align:left;">
100.0%
</td>
</tr>
</tbody>
</table>
</div>
<div id="dtm-1" class="section level4 hasAnchor" number="3.2.3.2">
<h4><span class="header-section-number">3.2.3.2</span> DTM<a href="sycmarsh.html#dtm-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="sycmarsh.html#cb40-1" tabindex="-1"></a><span class="fu">plt_rast_poly_fn</span>(</span>
<span id="cb40-2"><a href="sycmarsh.html#cb40-2" tabindex="-1"></a>  <span class="at">rast =</span> cloud2trees_ans<span class="sc">$</span>dtm_rast</span>
<span id="cb40-3"><a href="sycmarsh.html#cb40-3" tabindex="-1"></a>  , <span class="at">poly =</span> aoi_sf</span>
<span id="cb40-4"><a href="sycmarsh.html#cb40-4" tabindex="-1"></a>  , <span class="at">title =</span> <span class="st">&quot;DTM (m)&quot;</span></span>
<span id="cb40-5"><a href="sycmarsh.html#cb40-5" tabindex="-1"></a>  , <span class="at">crop =</span> T</span>
<span id="cb40-6"><a href="sycmarsh.html#cb40-6" tabindex="-1"></a>  , <span class="at">buff =</span> <span class="dv">22</span></span>
<span id="cb40-7"><a href="sycmarsh.html#cb40-7" tabindex="-1"></a>  , <span class="at">col =</span> <span class="st">&quot;navy&quot;</span></span>
<span id="cb40-8"><a href="sycmarsh.html#cb40-8" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb40-9"><a href="sycmarsh.html#cb40-9" tabindex="-1"></a>  harrypotter<span class="sc">::</span><span class="fu">scale_fill_hp</span>(</span>
<span id="cb40-10"><a href="sycmarsh.html#cb40-10" tabindex="-1"></a>    <span class="at">option =</span> <span class="st">&quot;mischief&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>, <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>(<span class="at">accuracy=</span><span class="dv">1</span>), <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">breaks_extended</span>(<span class="at">n=</span><span class="dv">6</span>)</span>
<span id="cb40-11"><a href="sycmarsh.html#cb40-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb40-12"><a href="sycmarsh.html#cb40-12" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(aoi_sf<span class="sc">$</span>study_site_lab, <span class="st">&quot; - UAS Lidar&quot;</span>))</span></code></pre></div>
<p><img src="dod_cloud2trees_demo_files/figure-html/unnamed-chunk-46-1.png" width="1008" /></p>
</div>
<div id="chm-1" class="section level4 hasAnchor" number="3.2.3.3">
<h4><span class="header-section-number">3.2.3.3</span> CHM<a href="sycmarsh.html#chm-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>plot the CHM and we’ll also add the extracted trees in gray</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="sycmarsh.html#cb41-1" tabindex="-1"></a><span class="fu">plt_rast_poly_fn</span>(</span>
<span id="cb41-2"><a href="sycmarsh.html#cb41-2" tabindex="-1"></a>  <span class="at">rast =</span> cloud2trees_ans<span class="sc">$</span>chm_rast</span>
<span id="cb41-3"><a href="sycmarsh.html#cb41-3" tabindex="-1"></a>  , <span class="at">poly =</span> aoi_sf</span>
<span id="cb41-4"><a href="sycmarsh.html#cb41-4" tabindex="-1"></a>  , <span class="at">title =</span> <span class="st">&quot;CHM (m)&quot;</span></span>
<span id="cb41-5"><a href="sycmarsh.html#cb41-5" tabindex="-1"></a>  , <span class="at">crop =</span> T</span>
<span id="cb41-6"><a href="sycmarsh.html#cb41-6" tabindex="-1"></a>  , <span class="at">buff =</span> <span class="dv">22</span></span>
<span id="cb41-7"><a href="sycmarsh.html#cb41-7" tabindex="-1"></a>  , <span class="at">col =</span> <span class="st">&quot;navy&quot;</span></span>
<span id="cb41-8"><a href="sycmarsh.html#cb41-8" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb41-9"><a href="sycmarsh.html#cb41-9" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_viridis_c</span>(</span>
<span id="cb41-10"><a href="sycmarsh.html#cb41-10" tabindex="-1"></a>    <span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>, <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>(<span class="at">accuracy=</span><span class="dv">1</span>), <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">breaks_extended</span>(<span class="at">n=</span><span class="dv">6</span>)</span>
<span id="cb41-11"><a href="sycmarsh.html#cb41-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb41-12"><a href="sycmarsh.html#cb41-12" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_sf</span>(</span>
<span id="cb41-13"><a href="sycmarsh.html#cb41-13" tabindex="-1"></a>    <span class="at">data =</span> cloud2trees_ans<span class="sc">$</span>crowns_sf <span class="sc">%&gt;%</span> </span>
<span id="cb41-14"><a href="sycmarsh.html#cb41-14" tabindex="-1"></a>      <span class="co"># dplyr::slice_sample(prop = 0.1) %&gt;% </span></span>
<span id="cb41-15"><a href="sycmarsh.html#cb41-15" tabindex="-1"></a>      sf<span class="sc">::</span><span class="fu">st_intersection</span>(</span>
<span id="cb41-16"><a href="sycmarsh.html#cb41-16" tabindex="-1"></a>        aoi_sf <span class="sc">%&gt;%</span> sf<span class="sc">::</span><span class="fu">st_transform</span>(sf<span class="sc">::</span><span class="fu">st_crs</span>(cloud2trees_ans<span class="sc">$</span>crowns_sf))</span>
<span id="cb41-17"><a href="sycmarsh.html#cb41-17" tabindex="-1"></a>      )</span>
<span id="cb41-18"><a href="sycmarsh.html#cb41-18" tabindex="-1"></a>    , <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">&quot;gray33&quot;</span>, <span class="at">lwd =</span> <span class="fl">0.5</span></span>
<span id="cb41-19"><a href="sycmarsh.html#cb41-19" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb41-20"><a href="sycmarsh.html#cb41-20" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(aoi_sf<span class="sc">$</span>study_site_lab, <span class="st">&quot; - UAS Lidar&quot;</span>))</span></code></pre></div>
<p><img src="dod_cloud2trees_demo_files/figure-html/unnamed-chunk-47-1.png" width="1008" /></p>
</div>
<div id="imagery-1" class="section level4 hasAnchor" number="3.2.3.4">
<h4><span class="header-section-number">3.2.3.4</span> Imagery<a href="sycmarsh.html#imagery-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>let’s check the tree extraction results (gray) on satellite imagery with a collection date that may not coincide with the point cloud collection date</p>
<p><em>we’ll sample the trees here so the output can be seen more clearly</em></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="sycmarsh.html#cb42-1" tabindex="-1"></a><span class="co"># add crowns</span></span>
<span id="cb42-2"><a href="sycmarsh.html#cb42-2" tabindex="-1"></a>plt_aoi_basemap <span class="sc">+</span></span>
<span id="cb42-3"><a href="sycmarsh.html#cb42-3" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_sf</span>(</span>
<span id="cb42-4"><a href="sycmarsh.html#cb42-4" tabindex="-1"></a>    <span class="at">data =</span> cloud2trees_ans<span class="sc">$</span>crowns_sf <span class="sc">%&gt;%</span> </span>
<span id="cb42-5"><a href="sycmarsh.html#cb42-5" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">prop =</span> <span class="fl">0.6</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb42-6"><a href="sycmarsh.html#cb42-6" tabindex="-1"></a>      sf<span class="sc">::</span><span class="fu">st_intersection</span>(</span>
<span id="cb42-7"><a href="sycmarsh.html#cb42-7" tabindex="-1"></a>        aoi_sf <span class="sc">%&gt;%</span> sf<span class="sc">::</span><span class="fu">st_transform</span>(sf<span class="sc">::</span><span class="fu">st_crs</span>(cloud2trees_ans<span class="sc">$</span>crowns_sf))</span>
<span id="cb42-8"><a href="sycmarsh.html#cb42-8" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb42-9"><a href="sycmarsh.html#cb42-9" tabindex="-1"></a>      sf<span class="sc">::</span><span class="fu">st_transform</span>(<span class="dv">4326</span>)</span>
<span id="cb42-10"><a href="sycmarsh.html#cb42-10" tabindex="-1"></a>    , <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">&quot;gray77&quot;</span>, <span class="at">lwd =</span> <span class="fl">0.1</span></span>
<span id="cb42-11"><a href="sycmarsh.html#cb42-11" tabindex="-1"></a>    , <span class="at">inherit.aes =</span> F</span>
<span id="cb42-12"><a href="sycmarsh.html#cb42-12" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-13"><a href="sycmarsh.html#cb42-13" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(aoi_sf<span class="sc">$</span>study_site_lab, <span class="st">&quot; - UAS Lidar&quot;</span>)) <span class="sc">+</span></span>
<span id="cb42-14"><a href="sycmarsh.html#cb42-14" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb42-15"><a href="sycmarsh.html#cb42-15" tabindex="-1"></a>    <span class="at">plot.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">0</span>))</span>
<span id="cb42-16"><a href="sycmarsh.html#cb42-16" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="dod_cloud2trees_demo_files/figure-html/unnamed-chunk-48-1.png" width="1008" /></p>
</div>
<div id="tree-attributes-spatial-1" class="section level4 hasAnchor" number="3.2.3.5">
<h4><span class="header-section-number">3.2.3.5</span> Tree Attributes Spatial<a href="sycmarsh.html#tree-attributes-spatial-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="sycmarsh.html#cb43-1" tabindex="-1"></a>plt_df_temp <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb43-2"><a href="sycmarsh.html#cb43-2" tabindex="-1"></a>  <span class="at">fill_var =</span> <span class="fu">c</span>(<span class="st">&quot;tree_height_m&quot;</span>, <span class="st">&quot;dbh_cm&quot;</span>, <span class="st">&quot;tree_cbh_m&quot;</span>, <span class="st">&quot;max_crown_diam_height_m&quot;</span>, <span class="st">&quot;landfire_crown_biomass_kg&quot;</span>)</span>
<span id="cb43-3"><a href="sycmarsh.html#cb43-3" tabindex="-1"></a>  , <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;Blues&quot;</span>, <span class="st">&quot;Oranges&quot;</span>, <span class="st">&quot;Greens&quot;</span>, <span class="st">&quot;Purples&quot;</span>, <span class="st">&quot;Reds&quot;</span>)</span>
<span id="cb43-4"><a href="sycmarsh.html#cb43-4" tabindex="-1"></a>  , <span class="at">title =</span> <span class="fu">c</span>(<span class="st">&quot;Height (m)&quot;</span>, <span class="st">&quot;DBH (cm)&quot;</span>, <span class="st">&quot;CBH (m)&quot;</span>, <span class="st">&quot;HMD (m)&quot;</span>, <span class="st">&quot;Crown</span><span class="sc">\n</span><span class="st">biomass (kg)&quot;</span>)</span>
<span id="cb43-5"><a href="sycmarsh.html#cb43-5" tabindex="-1"></a>)</span>
<span id="cb43-6"><a href="sycmarsh.html#cb43-6" tabindex="-1"></a></span>
<span id="cb43-7"><a href="sycmarsh.html#cb43-7" tabindex="-1"></a>plts_temp <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(plt_df_temp) <span class="sc">%&gt;%</span> </span>
<span id="cb43-8"><a href="sycmarsh.html#cb43-8" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(</span>
<span id="cb43-9"><a href="sycmarsh.html#cb43-9" tabindex="-1"></a>    \(x)</span>
<span id="cb43-10"><a href="sycmarsh.html#cb43-10" tabindex="-1"></a>    <span class="fu">plt_crown_attr_fn</span>(</span>
<span id="cb43-11"><a href="sycmarsh.html#cb43-11" tabindex="-1"></a>      <span class="at">crowns =</span> cloud2trees_ans<span class="sc">$</span>crowns_sf</span>
<span id="cb43-12"><a href="sycmarsh.html#cb43-12" tabindex="-1"></a>      , <span class="at">aoi =</span> aoi_sf</span>
<span id="cb43-13"><a href="sycmarsh.html#cb43-13" tabindex="-1"></a>      , <span class="at">lwd =</span> <span class="fl">0.6</span></span>
<span id="cb43-14"><a href="sycmarsh.html#cb43-14" tabindex="-1"></a>      , <span class="at">fill_var =</span> plt_df_temp<span class="sc">$</span>fill_var[x]</span>
<span id="cb43-15"><a href="sycmarsh.html#cb43-15" tabindex="-1"></a>      , <span class="at">palette =</span> plt_df_temp<span class="sc">$</span>palette[x]</span>
<span id="cb43-16"><a href="sycmarsh.html#cb43-16" tabindex="-1"></a>      , <span class="at">title =</span> plt_df_temp<span class="sc">$</span>title[x]</span>
<span id="cb43-17"><a href="sycmarsh.html#cb43-17" tabindex="-1"></a>    )  </span>
<span id="cb43-18"><a href="sycmarsh.html#cb43-18" tabindex="-1"></a>  )</span>
<span id="cb43-19"><a href="sycmarsh.html#cb43-19" tabindex="-1"></a><span class="co"># combine with patchwork</span></span>
<span id="cb43-20"><a href="sycmarsh.html#cb43-20" tabindex="-1"></a>patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(plts_temp, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb43-21"><a href="sycmarsh.html#cb43-21" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(</span>
<span id="cb43-22"><a href="sycmarsh.html#cb43-22" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">paste0</span>(aoi_sf<span class="sc">$</span>study_site_lab, <span class="st">&quot; - UAS Lidar&quot;</span>)</span>
<span id="cb43-23"><a href="sycmarsh.html#cb43-23" tabindex="-1"></a>    <span class="co"># , subtitle = &quot;huh&quot;</span></span>
<span id="cb43-24"><a href="sycmarsh.html#cb43-24" tabindex="-1"></a>    <span class="co"># , caption = &quot;hey&quot;</span></span>
<span id="cb43-25"><a href="sycmarsh.html#cb43-25" tabindex="-1"></a>    , <span class="at">theme =</span> ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb43-26"><a href="sycmarsh.html#cb43-26" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>))</span>
<span id="cb43-27"><a href="sycmarsh.html#cb43-27" tabindex="-1"></a>    )</span>
<span id="cb43-28"><a href="sycmarsh.html#cb43-28" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="dod_cloud2trees_demo_files/figure-html/unnamed-chunk-49-1.png" width="1008" /></p>
</div>
<div id="tree-attributes-summary-stats-1" class="section level4 hasAnchor" number="3.2.3.6">
<h4><span class="header-section-number">3.2.3.6</span> Tree Attributes Summary Stats<a href="sycmarsh.html#tree-attributes-summary-stats-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="sycmarsh.html#cb44-1" tabindex="-1"></a><span class="fu">stats_sum_fn</span>(<span class="at">crowns =</span> cloud2trees_ans<span class="sc">$</span>crowns_sf, <span class="at">aoi =</span> aoi_sf, <span class="at">unit =</span> <span class="fu">paste0</span>(aoi_sf<span class="sc">$</span>study_site_lab, <span class="st">&quot; - UAS Lidar&quot;</span>))</span></code></pre></div>
<table class="table" style="font-size: 13px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-50">Table 3.4: </span>Summary statistics for selected metrics
</caption>
<thead>
<tr>
<th style="text-align:left;">
Unit Name
</th>
<th style="text-align:left;">
Metric
</th>
<th style="text-align:left;">
Mean
</th>
<th style="text-align:left;">
Median
</th>
<th style="text-align:left;">
Std Dev
</th>
<th style="text-align:left;">
Range
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="6">
Sycan Marsh (OR) - UAS Lidar<br>(4,435 trees)
</td>
<td style="text-align:left;">
Height (m)
</td>
<td style="text-align:left;">
11.5
</td>
<td style="text-align:left;">
11.2
</td>
<td style="text-align:left;">
6.9
</td>
<td style="text-align:left;">
2.0—34.2
</td>
</tr>
<tr>
<td style="text-align:left;">
DBH (cm)
</td>
<td style="text-align:left;">
22.4
</td>
<td style="text-align:left;">
19.5
</td>
<td style="text-align:left;">
15.7
</td>
<td style="text-align:left;">
3.6—82.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Crown Base Ht. (m)
</td>
<td style="text-align:left;">
4.1
</td>
<td style="text-align:left;">
4.0
</td>
<td style="text-align:left;">
1.6
</td>
<td style="text-align:left;">
1.5—14.5
</td>
</tr>
<tr>
<td style="text-align:left;">
HMD (m)
</td>
<td style="text-align:left;">
4.8
</td>
<td style="text-align:left;">
4.7
</td>
<td style="text-align:left;">
2.7
</td>
<td style="text-align:left;">
0.1—16.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Cruz CBD<br>kg m<sup>-3</sup>
</td>
<td style="text-align:left;">
0.299
</td>
<td style="text-align:left;">
0.289
</td>
<td style="text-align:left;">
0.099
</td>
<td style="text-align:left;">
0.090—1.852
</td>
</tr>
<tr>
<td style="text-align:left;">
LANDFIRE CBD<br>kg m<sup>-3</sup>
</td>
<td style="text-align:left;">
0.147
</td>
<td style="text-align:left;">
0.134
</td>
<td style="text-align:left;">
0.075
</td>
<td style="text-align:left;">
0.052—1.188
</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-preparation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="fort-stewart-ga.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

</body>

</html>
